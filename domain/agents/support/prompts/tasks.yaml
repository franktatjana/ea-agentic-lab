# Support Agent Task Prompts
# Purpose: Task-specific prompts using CAF framework (Context, Action, Format)
# Reference: Agent config defined in agents/support_agent.yaml

# ============================================================================
# SUPPORT INTELLIGENCE PROMPTS
# ============================================================================
intelligence:

  analyze_ticket_patterns:
    name: "Analyze Ticket Patterns"
    description: "Detect patterns in support tickets"
    prompt: |
      Context: Analyzing support tickets for account.
      Customer: {customer_name}
      Period: {time_period}
      Ticket data: {ticket_summary}

      Action: Detect patterns that indicate:
      - Repeat issues (same problem multiple times)
      - Usage gaps (low utilization signals)
      - Performance complaints
      - Configuration questions (training needs)
      - Feature requests
      - Escalation patterns

      Format:
      Support Pattern Analysis: {customer_name}
      Period: {time_period}
      Total tickets: {count}

      Pattern Detection:
      | Pattern | Instances | Signal | Recommended Action |
      |---------|-----------|--------|-------------------|
      | Repeat issues | {count} | {description} | Notify SA for root cause |
      | Usage gaps | {count} | {description} | Adoption concern → CA |
      | Performance | {count} | {description} | Architecture review → SA |
      | Config questions | {count} | {description} | Training opportunity → CS |
      | Feature requests | {count} | {description} | Product feedback → PM |
      | Escalations | {count} | {description} | Account risk → AE + SM |

      Key Insights:
      - {insight 1}
      - {insight 2}

      Recommended Actions:
      - {action 1}: Owner: {agent}
      - {action 2}: Owner: {agent}

      Account Health Signal: {GREEN/YELLOW/RED}

  assess_support_health:
    name: "Assess Support Health"
    description: "Evaluate support health for account"
    prompt: |
      Context: Support health assessment for account.
      Customer: {customer_name}
      Current period: {period}
      Previous period metrics: {previous_metrics}
      Current metrics: {current_metrics}

      Action: Assess support health using signals:
      - GREEN: Stable/decreasing volume, no critical/high, self-service up, CSAT >4.5
      - YELLOW: Increasing volume, high recurring, SLA at risk, CSAT 4.0-4.5
      - RED: Multiple critical, same issue >3x, SLA breached, CSAT <4.0

      Format:
      Support Health Assessment: {customer_name}
      Period: {period}

      Overall Health: {GREEN/YELLOW/RED}

      Metric Comparison:
      | Metric | Previous | Current | Trend |
      |--------|----------|---------|-------|
      | Ticket volume | {count} | {count} | {up/down/stable} |
      | Critical tickets | {count} | {count} | {trend} |
      | High tickets | {count} | {count} | {trend} |
      | MTTR | {hours} | {hours} | {trend} |
      | CSAT | {score} | {score} | {trend} |
      | SLA compliance | {%} | {%} | {trend} |

      Health Indicators:
      GREEN indicators met:
      - [ ] Ticket volume stable or decreasing
      - [ ] No critical/high in 30 days
      - [ ] Self-service resolution increasing
      - [ ] CSAT > 4.5

      YELLOW indicators present:
      - [ ] Ticket volume increasing
      - [ ] High severity tickets recurring
      - [ ] Response time SLA at risk
      - [ ] CSAT 4.0-4.5

      RED indicators present:
      - [ ] Multiple critical tickets
      - [ ] Same issue > 3 times
      - [ ] SLA breached
      - [ ] CSAT < 4.0

      Key Concerns:
      - {concern 1}

      Recommended Actions:
      - {action}

  generate_support_digest:
    name: "Generate Support Digest"
    description: "Create weekly support summary for account team"
    prompt: |
      Context: Weekly support digest for account team.
      Customer: {customer_name}
      Week: {week}
      Ticket activity: {activity_summary}

      Action: Create digest covering:
      - Ticket summary by severity
      - Open issues
      - Notable incidents
      - Customer sentiment
      - Trends

      Format:
      Support Digest: {customer_name}
      Week ending: {date}

      Summary:
      {1-2 sentence overview}

      Ticket Activity:
      | Severity | Opened | Closed | Open |
      |----------|--------|--------|------|
      | Critical | {count} | {count} | {count} |
      | High | {count} | {count} | {count} |
      | Medium | {count} | {count} | {count} |
      | Low | {count} | {count} | {count} |

      Key Metrics:
      - MTTR: {hours}
      - SLA compliance: {%}
      - CSAT: {score}

      Notable Issues:
      - {issue 1}: Status: {status}

      Open Items Requiring Attention:
      - {item}

      Customer Sentiment: {positive/neutral/negative}
      Evidence: {what indicates sentiment}

      Trends:
      - {trend observation}

      Recommendations for Account Team:
      - {recommendation}

# ============================================================================
# DSE ENGAGEMENT PROMPTS
# ============================================================================
dse:

  dse_engagement_assessment:
    name: "DSE Engagement Assessment"
    description: "Assess if account qualifies for DSE"
    prompt: |
      Context: Evaluating DSE engagement for account.
      Customer: {customer_name}
      Account tier: {tier}
      Support history: {support_summary}
      Current situation: {situation}

      Action: Assess DSE engagement criteria:
      - Strategic account tier
      - Complex deployment
      - High support volume
      - Customer request
      - Post-incident relationship repair

      Format:
      DSE Engagement Assessment: {customer_name}

      Qualification Criteria:
      | Criterion | Met | Evidence |
      |-----------|-----|----------|
      | Strategic account | {Y/N} | {tier/revenue} |
      | Complex deployment | {Y/N} | {description} |
      | High support volume | {Y/N} | {ticket count} |
      | Customer request | {Y/N} | {details} |
      | Relationship repair needed | {Y/N} | {incident reference} |

      Recommendation: {ASSIGN_DSE / NOT_QUALIFIED / REVIEW_NEEDED}

      If Qualified:
      - Recommended DSE: {name if available}
      - Engagement type: {proactive/reactive/both}
      - Priority activities: {list}

      Expected Outcomes:
      - {outcome 1}

      Resource Impact:
      - DSE time required: {estimate}

  dse_monthly_summary:
    name: "DSE Monthly Summary"
    description: "Generate monthly DSE summary for account"
    prompt: |
      Context: Monthly DSE summary for strategic account.
      Customer: {customer_name}
      DSE: {dse_name}
      Month: {month}
      Activities: {activities_log}

      Action: Create monthly DSE summary:
      - Proactive activities completed
      - Reactive support provided
      - Health check findings
      - Recommendations

      Format:
      DSE Monthly Summary: {customer_name}
      Month: {month}
      DSE: {dse_name}

      Proactive Activities:
      - [ ] Health check completed: {findings}
      - [ ] Best practice review: {observations}
      - [ ] Upgrade planning: {status}

      Reactive Support:
      - Tickets handled: {count}
      - Escalations managed: {count}
      - Cross-functional coordination: {instances}

      Key Accomplishments:
      - {accomplishment 1}

      Issues Resolved:
      - {issue}: {resolution}

      Ongoing Concerns:
      - {concern}: {action}

      Recommendations:
      - {recommendation 1}

      Metrics:
      - Customer health impact: {improved/stable/declined}
      - CSAT for DSE interactions: {score}

      Next Month Focus:
      - {priority 1}

# ============================================================================
# ESCALATION MANAGEMENT PROMPTS
# ============================================================================
escalation:

  triage_escalation:
    name: "Triage Support Escalation"
    description: "Triage incoming support escalation"
    prompt: |
      Context: Support escalation received.
      Customer: {customer_name}
      Ticket: {ticket_id}
      Issue: {issue_description}
      Current severity: {severity}
      Escalation reason: {reason}

      Action: Triage escalation:
      - Validate severity
      - Determine escalation path
      - Identify required resources
      - Set communication plan

      Format:
      Escalation Triage: {ticket_id}
      Customer: {customer_name}

      Issue Summary:
      {brief description}

      Severity Assessment:
      - Current: {severity}
      - Validated: {validated_severity}
      - Justification: {why}

      Business Impact:
      - {impact description}

      Escalation Path:
      - Type: {technical/commercial/relationship}
      - Path: Support → {next level}
      - Reason: {why this path}

      Required Resources:
      - {resource/person}: {for what}

      Communication Plan:
      - Customer update: {when/how}
      - Internal notification: {who/when}

      Immediate Actions:
      - {action 1}

  incident_report:
    name: "Generate Incident Report"
    description: "Create post-incident report"
    prompt: |
      Context: Generating incident report for critical/high severity.
      Customer: {customer_name}
      Incident: {incident_id}
      Summary: {incident_summary}
      Resolution: {resolution}

      Action: Create incident report covering:
      - Incident timeline
      - Root cause
      - Resolution steps
      - Prevention measures
      - Customer communication

      Format:
      Incident Report: {incident_id}
      Customer: {customer_name}
      Severity: {severity}
      Duration: {start} to {end}

      Executive Summary:
      {2-3 sentence summary}

      Timeline:
      | Time | Event |
      |------|-------|
      | {time} | Incident reported |
      | {time} | Investigation started |
      | {time} | Root cause identified |
      | {time} | Resolution implemented |
      | {time} | Customer confirmed resolution |

      Root Cause:
      {description of root cause}

      Impact:
      - Systems affected: {list}
      - Business impact: {description}
      - Users impacted: {count if known}

      Resolution:
      {what was done to resolve}

      Prevention:
      - Immediate: {action}
      - Long-term: {action}

      Customer Communication:
      - Sent: {what was communicated}
      - Follow-up: {planned communication}

      Lessons Learned:
      - {lesson 1}

      Action Items:
      | Action | Owner | Due |
      |--------|-------|-----|
      | {action} | {owner} | {date} |

  escalation_to_account_team:
    name: "Escalate to Account Team"
    description: "Escalate support issue to account team"
    prompt: |
      Context: Issue requires account team attention.
      Customer: {customer_name}
      Issue: {issue_summary}
      Escalation reason: {reason}

      Action: Prepare escalation to account team:
      - Summarize issue and impact
      - Provide context
      - Recommend action
      - Identify urgency

      Format:
      Account Team Escalation: {customer_name}

      Issue Summary:
      {brief description}

      Why Escalating:
      - {reason}

      Customer Impact:
      - {impact}

      Support Actions Taken:
      - {action 1}

      Account Context:
      - Recent interactions: {summary}
      - Relationship status: {observation}
      - Customer sentiment: {positive/neutral/negative}

      Urgency: {HIGH/MEDIUM/LOW}
      Reason: {why this urgency}

      Recommended Action:
      - {what account team should do}

      Response Needed By:
      - {date/time}

      Contact for Questions:
      - {support contact}

# ============================================================================
# REPORTING PROMPTS
# ============================================================================
reporting:

  quarterly_support_review:
    name: "Quarterly Support Review"
    description: "Prepare QBR support section"
    prompt: |
      Context: Preparing support section for QBR.
      Customer: {customer_name}
      Quarter: {quarter}
      Support data: {quarterly_data}

      Action: Prepare QBR support content:
      - Ticket trends
      - SLA performance
      - Major incidents
      - Improvements made
      - Recommendations

      Format:
      Support Review: {customer_name}
      Quarter: {quarter}

      Executive Summary:
      {2-3 sentence overview}

      Ticket Summary:
      | Severity | Q-1 | Current Q | Change |
      |----------|-----|-----------|--------|
      | Critical | {count} | {count} | {%} |
      | High | {count} | {count} | {%} |
      | Total | {count} | {count} | {%} |

      SLA Performance:
      - Response time: {%} compliance
      - Resolution time: {%} compliance
      - Overall: {above/at/below} target

      Customer Satisfaction:
      - CSAT: {score}
      - Trend: {improving/stable/declining}
      - Feedback themes: {themes}

      Major Incidents:
      - {incident 1}: {brief summary}

      Improvements Made:
      - {improvement 1}

      Recommendations for Next Quarter:
      - {recommendation 1}

      DSE Engagement (if applicable):
      - Activities: {summary}
      - Impact: {outcomes}

  trend_analysis:
    name: "Support Trend Analysis"
    description: "Analyze support trends over time"
    prompt: |
      Context: Analyzing support trends for account.
      Customer: {customer_name}
      Period: {time_period}
      Historical data: {historical_data}

      Action: Analyze trends:
      - Volume trends
      - Severity distribution changes
      - Resolution time trends
      - Recurring issue patterns
      - Satisfaction trends

      Format:
      Support Trend Analysis: {customer_name}
      Period: {time_period}

      Volume Trend:
      - Direction: {increasing/decreasing/stable}
      - Rate: {%} change over period
      - Anomalies: {any spikes or drops}

      Severity Distribution:
      | Severity | Period Start | Period End | Trend |
      |----------|--------------|------------|-------|
      | Critical/High | {%} | {%} | {trend} |
      | Medium/Low | {%} | {%} | {trend} |

      Resolution Performance:
      - MTTR trend: {improving/stable/degrading}
      - SLA compliance trend: {improving/stable/degrading}

      Recurring Issues:
      - {issue category}: {frequency}, {trend}

      Satisfaction Trend:
      - CSAT: {start} → {end}
      - Direction: {improving/stable/declining}

      Key Insights:
      - {insight 1}

      Recommended Actions:
      - {action based on trends}

      Forecast:
      - Expected next quarter: {prediction}

  feature_request_summary:
    name: "Feature Request Summary"
    description: "Summarize feature requests from support"
    prompt: |
      Context: Compiling feature requests from support tickets.
      Customer: {customer_name}
      Period: {time_period}
      Requests: {request_list}

      Action: Summarize feature requests for PM:
      - Categorize requests
      - Assess frequency/urgency
      - Capture customer context
      - Recommend prioritization

      Format:
      Feature Request Summary: {customer_name}
      Period: {time_period}

      Request Overview:
      Total requests: {count}
      Categories: {list}

      Top Requests by Frequency:
      | Request | Count | Urgency | Customer Impact |
      |---------|-------|---------|-----------------|
      | {request} | {count} | {H/M/L} | {impact} |

      Detailed Requests:

      Request: {title}
      - Description: {description}
      - Frequency: {count}
      - Customer quote: "{quote}"
      - Business impact: {impact}
      - Workaround: {current workaround if any}

      Patterns Observed:
      - {pattern 1}

      Recommendations for PM:
      - Priority: {request 1} - Reason: {why}

      Customer Commitment (if any):
      - {any commitments made to customer}

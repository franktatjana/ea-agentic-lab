# InfoSec Agent Task Prompts
# Purpose: Task-specific prompts using CAF framework (Context, Action, Format)
# Reference: Agent config defined in agents/infosec_agent.yaml

# ============================================================================
# SECURITY QUESTIONNAIRE PROMPTS
# ============================================================================
questionnaires:

  process_questionnaire:
    name: "Process Security Questionnaire"
    description: "Complete security questionnaire for customer"
    prompt: |
      Context: Security questionnaire received from customer.
      Customer: {customer_name}
      Questionnaire type: {type} (SIG/CAIQ/custom)
      Question count: {count}
      Due date: {due_date}

      Action: Process questionnaire:
      - Identify question categories
      - Check for previously answered similar questions
      - Flag questions requiring SME input
      - Draft responses following templates

      Format:
      Questionnaire Processing: {customer_name}
      Type: {type}
      Questions: {count}

      Category Breakdown:
      - Data Protection: {count}
      - Access Control: {count}
      - Compliance: {count}
      - Infrastructure: {count}
      - Vendor Management: {count}

      Questions with Existing Answers: {count}
      Questions Needing Fresh Response: {count}
      Questions Requiring SME: {count}

      SME Needed:
      | Question | Topic | Recommended SME |
      |----------|-------|-----------------|
      | Q{n} | {topic} | {person/team} |

      Timeline:
      - Draft completion: {date}
      - Review: {date}
      - Submission: {date}

  answer_question:
    name: "Answer Security Question"
    description: "Draft answer to specific security question"
    prompt: |
      Context: Answering security questionnaire question.
      Question: {question_text}
      Category: {category}
      Customer context: {customer_context}

      Action: Draft response following principles:
      - Answer the question asked (not adjacent questions)
      - Be specific, not vague
      - Provide evidence references
      - If partially compliant, explain clearly

      Format:
      Question: {question_text}

      Answer: {Yes/No/Partial/N/A}

      Response:
      {Detailed response with evidence}

      Evidence Reference:
      - {certification/document/link}

      Notes for Review:
      - {any caveats or context}

  bulk_questionnaire_response:
    name: "Bulk Questionnaire Response"
    description: "Generate responses for multiple questions"
    prompt: |
      Context: Multiple questions to answer from questionnaire.
      Customer: {customer_name}
      Questions: {question_list}

      Action: Generate responses for all questions:
      - Use standard answer templates where applicable
      - Maintain consistent terminology
      - Flag any questions needing custom response

      Format:
      Questionnaire Responses: {customer_name}

      | # | Question | Answer | Response | Evidence |
      |---|----------|--------|----------|----------|
      | 1 | {q1} | Yes | {response} | {evidence} |
      | 2 | {q2} | Partial | {response} | {evidence} |

      Questions Requiring Custom Response:
      - Q{n}: {reason}

      Questions Flagged for Review:
      - Q{n}: {concern}

# ============================================================================
# GAP ANALYSIS PROMPTS
# ============================================================================
gap_analysis:

  assess_customer_requirements:
    name: "Assess Customer Security Requirements"
    description: "Analyze customer security requirements vs capabilities"
    prompt: |
      Context: Customer has specific security requirements.
      Customer: {customer_name}
      Requirements: {requirements_list}
      Industry: {industry}

      Action: Assess requirements against our capabilities:
      - Map requirements to our certifications
      - Identify gaps between requirement and capability
      - Classify gap severity (blocker, workaround, roadmap)
      - Propose compensating controls or mitigations

      Format:
      Security Requirements Assessment: {customer_name}
      Industry: {industry}

      Requirements Analysis:
      | Requirement | Status | Gap | Mitigation |
      |-------------|--------|-----|------------|
      | {req 1} | Compliant | - | - |
      | {req 2} | Gap | {gap description} | {mitigation} |

      Summary:
      - Compliant: {count}
      - Gaps with workaround: {count}
      - Gaps on roadmap: {count}
      - Blockers: {count}

      Blockers (if any):
      - {blocker}: {impact on deal}

      Recommended Actions:
      - {action to address gaps}

  compliance_gap_assessment:
    name: "Compliance Gap Assessment"
    description: "Assess gaps for specific compliance framework"
    prompt: |
      Context: Customer requires specific compliance framework.
      Customer: {customer_name}
      Framework: {framework} (SOC2/ISO27001/GDPR/HIPAA/FedRAMP/etc)
      Our status: {current_certification_status}

      Action: Assess compliance gap:
      - What does the framework require?
      - What is our current status?
      - What gaps exist?
      - What is the path to compliance?

      Format:
      Compliance Assessment: {framework}
      Customer: {customer_name}

      Framework Requirements:
      - {key requirements}

      Our Status:
      - Certified: {YES/NO}
      - Certification date: {date or N/A}
      - Scope: {what's covered}

      Gap Analysis:
      | Domain | Requirement | Our Status | Gap |
      |--------|-------------|------------|-----|
      | {domain} | {requirement} | {status} | {gap if any} |

      Risk Level: {HIGH/MEDIUM/LOW}
      Impact on Deal: {description}

      Options:
      1. {option 1 with implications}
      2. {option 2 with implications}

      Recommendation:
      - {recommended path forward}

  data_residency_assessment:
    name: "Data Residency Assessment"
    description: "Assess data residency requirements and options"
    prompt: |
      Context: Customer has data residency requirements.
      Customer: {customer_name}
      Required regions: {regions}
      Data types: {data_types}

      Action: Assess data residency options:
      - What data will be processed?
      - What are our regional deployment options?
      - How does data flow in our architecture?
      - What options can we offer?

      Format:
      Data Residency Assessment: {customer_name}

      Customer Requirements:
      - Data must reside in: {regions}
      - Data types: {types}
      - Regulatory driver: {regulation}

      Our Capabilities:
      - Available regions: {regions}
      - Data storage: {where data is stored}
      - Data processing: {where data is processed}
      - Data flow: {description of flows}

      Gap Analysis:
      | Data Type | Requirement | Current | Gap |
      |-----------|-------------|---------|-----|
      | {type} | {region} | {current} | {gap} |

      Options:
      1. {option with pros/cons}

      Recommendation:
      - {recommended approach}

      Architecture Changes Required:
      - {if any}

# ============================================================================
# RISK TRANSLATION PROMPTS
# ============================================================================
risk_translation:

  translate_security_concern:
    name: "Translate Security Concern"
    description: "Convert security concern to business impact"
    prompt: |
      Context: Security concern needs business translation.
      Concern: {security_concern}
      Customer: {customer_name}
      Deal context: {deal_context}

      Action: Translate security concern to business terms:
      - What is the technical issue?
      - What is the business impact?
      - What is the risk level?
      - What are the options?

      Format:
      Security Concern Translation

      Technical Issue:
      {description of the security concern}

      Business Impact:
      - For customer: {how this affects them}
      - For deal: {impact on opportunity}
      - Risk level: {HIGH/MEDIUM/LOW}

      Stakeholder Message:
      {How to explain this to non-technical stakeholders}

      Options:
      1. {option with trade-offs}

      Recommendation:
      - {recommended path}

  prepare_security_briefing:
    name: "Prepare Security Briefing"
    description: "Prepare security briefing for customer meeting"
    prompt: |
      Context: Preparing for customer security review meeting.
      Customer: {customer_name}
      Attendees: {attendees}
      Topics: {topics_to_cover}
      Known concerns: {concerns}

      Action: Prepare security briefing:
      - Address known concerns
      - Present our security posture
      - Anticipate follow-up questions
      - Prepare supporting evidence

      Format:
      Security Briefing: {customer_name}
      Meeting: {date}
      Attendees: {attendees}

      Opening (set context):
      - {brief on our security program}

      Topic Coverage:
      {Topic 1}:
      - Key points: {points}
      - Evidence: {references}
      - Anticipated questions: {questions}
      - Prepared responses: {responses}

      Known Concerns Response:
      | Concern | Response | Evidence |
      |---------|----------|----------|
      | {concern} | {response} | {evidence} |

      Materials to Share:
      - {document list}

      Follow-up Commitments:
      - {what we'll provide after meeting}

# ============================================================================
# DEAL ENABLEMENT PROMPTS
# ============================================================================
deal_enablement:

  unblock_security_issue:
    name: "Unblock Security Issue"
    description: "Find path to resolve security blocker"
    prompt: |
      Context: Security issue blocking deal progress.
      Customer: {customer_name}
      Blocker: {blocker_description}
      Deal value: {deal_value}
      Timeline: {timeline}

      Action: Find path to unblock:
      - Understand the real concern
      - Identify possible solutions
      - Assess feasibility and timeline
      - Recommend approach

      Format:
      Security Blocker Resolution: {customer_name}

      Blocker:
      {description of the issue}

      Root Concern:
      {what the customer is really worried about}

      Solution Options:
      1. {solution 1}
         - Feasibility: {HIGH/MEDIUM/LOW}
         - Timeline: {estimate}
         - Effort: {description}

      2. {solution 2}
         ...

      Recommended Approach:
      - {recommended solution}
      - {why this is best}

      Customer Communication:
      {suggested message to customer}

      Internal Actions:
      - {what we need to do}

  expedite_questionnaire:
    name: "Expedite Questionnaire"
    description: "Fast-track questionnaire completion"
    prompt: |
      Context: Customer needs questionnaire completed urgently.
      Customer: {customer_name}
      Questionnaire: {type}
      Questions: {count}
      Deadline: {deadline}
      Current status: {status}

      Action: Plan expedited completion:
      - Prioritize critical questions
      - Identify parallel workstreams
      - Allocate resources
      - Set review checkpoints

      Format:
      Expedited Questionnaire Plan: {customer_name}
      Deadline: {deadline}
      Days remaining: {days}

      Prioritization:
      - Critical (must complete): {count}
      - Important (should complete): {count}
      - Optional (if time permits): {count}

      Workstream Assignments:
      | Section | Owner | Due | Status |
      |---------|-------|-----|--------|
      | {section} | {owner} | {date} | {status} |

      Review Checkpoints:
      - {date}: {milestone}

      Risk Mitigation:
      - {risk}: {mitigation}

      Escalation Triggers:
      - {when to escalate}

  certification_roadmap:
    name: "Certification Roadmap"
    description: "Provide certification roadmap for customer"
    prompt: |
      Context: Customer asking about certification we don't have.
      Customer: {customer_name}
      Certification: {certification_name}
      Customer timeline: {when_they_need_it}
      Our status: {current_status}

      Action: Provide clear roadmap:
      - Current status
      - Planned timeline
      - Interim options
      - Contractual commitment options

      Format:
      Certification Roadmap: {certification_name}
      Customer: {customer_name}

      Current Status:
      - {where we are today}

      Roadmap:
      | Milestone | Target Date | Status |
      |-----------|-------------|--------|
      | {milestone} | {date} | {status} |

      Customer Timeline:
      - They need: {date}
      - We expect: {date}
      - Gap: {analysis}

      Interim Options:
      1. {option with description}

      Contractual Commitment:
      - We can commit to: {what we can contractually guarantee}

      Recommendation:
      - {recommended approach}

# ============================================================================
# COMPLIANCE TRACKING PROMPTS
# ============================================================================
compliance_tracking:

  certification_status_update:
    name: "Certification Status Update"
    description: "Update on certification status"
    prompt: |
      Context: Certification status update needed.
      Certification: {certification_name}
      Current status: {status}
      Renewal date: {date}

      Action: Provide status update:
      - Current certification status
      - Upcoming milestones
      - Any risks or concerns
      - Actions needed

      Format:
      Certification Status: {certification_name}

      Status: {ACTIVE/IN_PROGRESS/EXPIRED/PLANNED}
      Current validity: {date range}
      Next renewal: {date}

      Recent Activity:
      - {audit/review activity}

      Upcoming:
      - {milestone}: {date}

      Risks/Concerns:
      - {any issues}

      Actions Needed:
      - {action}: Owner: {who} | Due: {date}

  evidence_library_update:
    name: "Evidence Library Update"
    description: "Update evidence library for compliance"
    prompt: |
      Context: Evidence library needs updating.
      Category: {category}
      Documents: {document_list}
      Last update: {date}

      Action: Review and update evidence:
      - Check document currency
      - Identify outdated items
      - Note what needs refresh
      - Track NDA requirements

      Format:
      Evidence Library Update: {category}

      Current Evidence:
      | Document | Version | Date | NDA Required | Status |
      |----------|---------|------|--------------|--------|
      | {doc} | {ver} | {date} | {Y/N} | {current/stale} |

      Updates Needed:
      - {document}: {what needs updating}

      New Evidence Available:
      - {new document to add}

      Actions:
      - {action to refresh evidence}

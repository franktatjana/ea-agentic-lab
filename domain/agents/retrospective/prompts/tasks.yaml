# Retrospective Agent Task Prompts
# Purpose: Task-specific prompts for win/loss analysis and lessons learned
# Framework: CAF (Context, Action, Format)
# Based on: Industry SA retrospective best practices

# ============================================================================
# WIN RETROSPECTIVE PROMPTS
# ============================================================================
win_retrospective:

  initiate_win_retro:
    name: "Initiate Win Retrospective"
    description: "Start structured retrospective for closed-won deal"
    prompt: |
      Context: Deal closed-won for {account_name}.
      Opportunity: {opportunity_name}
      ARR: {arr}
      Close date: {close_date}
      Sales cycle: {sales_cycle_days} days

      Action: Initiate win retrospective:
      - Gather deal timeline and key events
      - Identify participants for retrospective
      - Prepare analysis framework
      - Schedule retrospective session (if needed)

      Format:
      - Deal summary (account, value, timeline)
      - Key milestones timeline
      - Participants to involve
      - Data to gather before analysis
      - Retrospective session agenda (if synchronous)

  analyze_win_factors:
    name: "Analyze Win Factors"
    description: "Deep analysis of why we won"
    prompt: |
      Context: Win retrospective for {account_name}.
      Deal history: {deal_history}
      POV results: {pov_results}
      Stakeholder map: {stakeholders}

      Action: Analyze win factors across categories:

      1. Value Proposition
         - What value resonated most?
         - Which use cases drove the decision?
         - How did we differentiate?

      2. Sales Execution
         - What sales motions worked?
         - How effective was discovery?
         - Did we engage right stakeholders?

      3. Technical Validation
         - How did POV contribute?
         - What technical proof points were decisive?
         - How well did we address concerns?

      4. Competitive Dynamics
         - Who did we compete against?
         - What was our competitive advantage?
         - How did we handle objections?

      5. Relationship & Trust
         - How strong was our champion?
         - What built trust with decision makers?
         - How did executive engagement help?

      Format:
      - Win factor analysis table:
        | Category | Key Factor | Evidence | Replicability |
      - Primary win drivers (top 3)
      - What we should repeat
      - What we got lucky on (not replicable)
      - Competitive insights gained

  document_win_learnings:
    name: "Document Win Learnings"
    description: "Create win retrospective document"
    prompt: |
      Context: Completing win retrospective for {account_name}.
      Analysis findings: {analysis_summary}
      Team input: {team_feedback}

      Action: Document win learnings:
      - Summarize key success factors
      - Extract replicable practices
      - Identify what to share with broader team
      - Create action items for future deals

      Format:
      - Executive summary (3 sentences)
      - Deal snapshot (account, ARR, cycle, competitor)
      - Success factors summary
      - Replicable practices (what to repeat)
      - Key learnings table:
        | Learning | Category | Applicability | Action |
      - Recommendations for similar deals
      - Knowledge to share (anonymized for broad distribution)
      - Competitive intelligence to log

# ============================================================================
# LOSS RETROSPECTIVE PROMPTS
# ============================================================================
loss_retrospective:

  initiate_loss_retro:
    name: "Initiate Loss Retrospective"
    description: "Start structured retrospective for closed-lost deal"
    prompt: |
      Context: Deal closed-lost for {account_name}.
      Opportunity: {opportunity_name}
      ARR: {arr}
      Loss date: {close_date}
      Loss reason (CRM): {loss_reason}
      Competitor: {competitor}

      Action: Initiate loss retrospective:
      - Gather complete deal timeline
      - Identify when momentum was lost
      - Prepare blameless analysis framework
      - Invite participants

      Format:
      - Deal summary (account, value, timeline)
      - Initial loss categorization
      - Key events timeline (highlight inflection points)
      - Participants to involve
      - Data to gather before analysis
      - Blameless retrospective guidelines

  analyze_loss_factors:
    name: "Analyze Loss Factors"
    description: "Deep analysis of why we lost"
    prompt: |
      Context: Loss retrospective for {account_name}.
      Deal history: {deal_history}
      Loss reason: {loss_reason}
      Competitor: {competitor}

      Action: Analyze loss factors across categories:

      1. Loss Classification
         - Primary loss type: [COMPETITOR|NO_DECISION|TECHNICAL|COMMERCIAL|RELATIONSHIP]
         - When did we lose momentum?
         - What was the tipping point?

      2. Competitive Analysis (if applicable)
         - Who won the deal?
         - What did competitor do better?
         - What features/capabilities were decisive?
         - Price/value comparison

      3. Sales Process Review
         - Did we qualify properly?
         - Did we engage the right people?
         - Were there warning signs we missed?
         - Was our sales motion appropriate?

      4. Technical Evaluation
         - Were there unmet technical requirements?
         - Did POV/POC meet expectations?
         - What technical objections weren't overcome?
         - Were we the right technical fit?

      5. Commercial Factors
         - Was pricing competitive?
         - Were terms acceptable?
         - Did we demonstrate sufficient value?
         - Was ROI clear to decision makers?

      Format:
      - Loss factor analysis table:
        | Category | Factor | Evidence | Controllable? |
      - Primary loss drivers (top 3)
      - Warning signs we missed
      - What we could have done differently
      - What was outside our control
      - Competitive insights gained

  document_loss_learnings:
    name: "Document Loss Learnings"
    description: "Create loss retrospective document"
    prompt: |
      Context: Completing loss retrospective for {account_name}.
      Analysis findings: {analysis_summary}
      Team input: {team_feedback}

      Action: Document loss learnings (blame-free):
      - Summarize what happened objectively
      - Extract process improvements
      - Identify competitive intelligence
      - Create actionable recommendations

      Format:
      - Executive summary (3 sentences, objective)
      - Deal snapshot (account, ARR, cycle, competitor, loss type)
      - Timeline of key events
      - Root cause analysis (5 Whys if applicable)
      - Learnings table:
        | Learning | Category | Preventable? | Recommendation |
      - Process improvements recommended
      - Competitive intelligence to log
      - Product feedback (if feature gap)
      - Resurrection potential assessment
      - Knowledge to share (anonymized)

  competitive_loss_deep_dive:
    name: "Competitive Loss Deep Dive"
    description: "Detailed analysis when lost to specific competitor"
    prompt: |
      Context: Lost to {competitor} at {account_name}.
      Competitor details: {competitor_info}
      Customer feedback: {customer_feedback}
      Our positioning: {our_positioning}

      Action: Deep dive on competitive loss:
      - What did competitor offer that we didn't?
      - How did their sales motion differ?
      - What was their pricing approach?
      - What messaging resonated?

      Format:
      - Competitor win analysis:
        | Dimension | Their Approach | Our Approach | Gap |
      - Decisive factors (what won it for them)
      - Messaging that resonated with customer
      - Pricing/commercial comparison
      - Feature/capability gaps
      - Relationship dynamics
      - Recommendations for next encounter
      - CI Agent update content

# ============================================================================
# PATTERN ANALYSIS PROMPTS
# ============================================================================
pattern_analysis:

  identify_patterns:
    name: "Identify Patterns Across Retrospectives"
    description: "Find recurring patterns in wins and losses"
    prompt: |
      Context: Analyzing retrospectives from {time_period}.
      Win retrospectives: {win_count}
      Loss retrospectives: {loss_count}
      Retrospective data: {retrospective_summaries}

      Action: Identify patterns:
      - What factors appear repeatedly in wins?
      - What factors appear repeatedly in losses?
      - Are there competitor-specific patterns?
      - Are there segment/industry patterns?

      Format:
      - Win patterns table:
        | Pattern | Frequency | Segments | Strength |
      - Loss patterns table:
        | Pattern | Frequency | Segments | Severity |
      - Competitor patterns:
        | Competitor | Win Pattern | Loss Pattern | Trend |
      - Emerging patterns (new this period)
      - Declining patterns (less frequent)
      - Recommended focus areas

  trend_analysis:
    name: "Retrospective Trend Analysis"
    description: "Analyze trends over time"
    prompt: |
      Context: Trend analysis for {time_period}.
      Historical patterns: {historical_patterns}
      Recent retrospectives: {recent_data}

      Action: Analyze trends:
      - How are win/loss patterns changing?
      - Are recommendations being implemented?
      - What's improving? What's getting worse?
      - Are there seasonal patterns?

      Format:
      - Trend summary (improving, stable, declining areas)
      - Pattern trajectory chart data:
        | Pattern | Previous | Current | Trend |
      - Implementation tracking:
        | Recommendation | Status | Impact |
      - Areas of concern (declining trends)
      - Areas of progress (improving trends)
      - Recommendations for next quarter

  generate_pattern_report:
    name: "Generate Pattern Report"
    description: "Create periodic pattern report for leadership"
    prompt: |
      Context: Generating {frequency} pattern report.
      Period: {period}
      Data: {pattern_data}

      Action: Generate pattern report:
      - Summarize key patterns
      - Highlight actionable insights
      - Recommend process changes
      - Identify escalations needed

      Format:
      - Executive summary
      - Win pattern highlights (what's working)
      - Loss pattern highlights (what needs fixing)
      - Competitive landscape summary
      - Top 5 recommendations
      - Escalations for leadership attention
      - Metrics summary:
        - Retrospectives completed: {count}
        - Average time to retrospective: {days}
        - Recommendations implemented: {percentage}

# ============================================================================
# KNOWLEDGE SHARING PROMPTS
# ============================================================================
knowledge_sharing:

  create_lessons_summary:
    name: "Create Lessons Learned Summary"
    description: "Create shareable lessons learned document"
    prompt: |
      Context: Creating lessons summary from {retrospective_id}.
      Original retrospective: {retrospective_content}
      Audience: {target_audience}

      Action: Create shareable summary:
      - Anonymize customer details if needed
      - Extract universally applicable learnings
      - Make recommendations actionable
      - Format for target audience

      Format:
      - Lessons learned summary
      - Situation (anonymized context)
      - Key learnings (numbered)
      - Recommendations
      - Applicable scenarios (when to apply these learnings)
      - Discussion questions for team sessions

  create_competitive_brief:
    name: "Create Competitive Intelligence Brief"
    description: "Extract competitive insights for CI team"
    prompt: |
      Context: Extracting competitive insights from retrospectives.
      Competitor: {competitor}
      Retrospective data: {retrospective_excerpts}

      Action: Create CI brief:
      - Summarize competitor tactics observed
      - Document pricing/positioning intelligence
      - Highlight feature comparisons
      - Recommend counter-positioning

      Format:
      - Competitor: {competitor}
      - Intelligence type: [WIN|LOSS|BOTH]
      - Tactics observed:
        | Tactic | Context | Effectiveness |
      - Pricing intelligence
      - Messaging that resonated
      - Feature gaps exploited
      - Recommended counter-moves
      - Confidence level: [HIGH|MEDIUM|LOW]

  create_product_feedback:
    name: "Create Product Feedback from Loss"
    description: "Document product feedback from loss retrospective"
    prompt: |
      Context: Product-related loss at {account_name}.
      Feature gap: {feature_gap}
      Customer requirements: {requirements}
      Competitive comparison: {competitive_features}

      Action: Create product feedback:
      - Document the gap clearly
      - Provide customer context
      - Quantify impact (deals lost, ARR)
      - Suggest prioritization

      Format:
      - Feedback type: [FEATURE_GAP|ENHANCEMENT|BUG|PRICING]
      - Summary (1 sentence)
      - Customer context (anonymized)
      - Requirements detail
      - Competitive comparison
      - Business impact:
        - Deals affected: {count}
        - ARR impact: {amount}
        - Win rate impact: {estimate}
      - Customer quotes (anonymized)
      - Suggested priority: [CRITICAL|HIGH|MEDIUM|LOW]
      - Related feedback (if any)

# ============================================================================
# PROCESS IMPROVEMENT PROMPTS
# ============================================================================
process_improvement:

  generate_recommendations:
    name: "Generate Process Improvement Recommendations"
    description: "Create actionable process improvements from patterns"
    prompt: |
      Context: Generating recommendations from pattern analysis.
      Patterns identified: {patterns}
      Current processes: {current_processes}

      Action: Generate recommendations:
      - What process changes would address patterns?
      - What's the expected impact?
      - What's the implementation effort?
      - Who owns each recommendation?

      Format:
      - Recommendations table:
        | Recommendation | Pattern Addressed | Impact | Effort | Owner |
      - Quick wins (low effort, high impact)
      - Strategic changes (high effort, high impact)
      - Implementation roadmap
      - Success metrics for each

  track_implementation:
    name: "Track Recommendation Implementation"
    description: "Track status of retrospective recommendations"
    prompt: |
      Context: Tracking recommendations from {time_period}.
      Recommendations: {recommendations_list}
      Current status: {status_updates}

      Action: Track implementation:
      - What recommendations were implemented?
      - What's the observed impact?
      - What's blocked or delayed?
      - What needs escalation?

      Format:
      - Implementation tracker:
        | Recommendation | Status | Impact Observed | Blockers |
      - Status summary:
        - Implemented: {count}
        - In progress: {count}
        - Blocked: {count}
        - Not started: {count}
      - Impact assessment
      - Escalations needed
      - Updated recommendations

  retrospective_effectiveness:
    name: "Assess Retrospective Program Effectiveness"
    description: "Evaluate if retrospective program is working"
    prompt: |
      Context: Assessing retrospective program effectiveness.
      Period: {assessment_period}
      Metrics: {program_metrics}

      Action: Assess effectiveness:
      - Are retrospectives being completed?
      - Are learnings being implemented?
      - Is win rate improving?
      - Are patterns being addressed?

      Format:
      - Program health: [HEALTHY|NEEDS_ATTENTION|AT_RISK]
      - Metrics dashboard:
        - Completion rate: {percentage}
        - Time to retrospective: {avg_days}
        - Implementation rate: {percentage}
        - Pattern recurrence: {trend}
      - What's working well
      - What needs improvement
      - Recommendations for program

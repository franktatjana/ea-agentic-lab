# PLAYBOOK: Security Stage Adoption
# Framework operationalization for AI agents
# Guides customers through security solution adoption journey

# ==============================================================================
# PLAYBOOK METADATA
# ==============================================================================
framework_name: "Security Stage Adoption"
framework_source: "Customer Success Best Practices"
playbook_mode: "GENERATIVE"  # Generates adoption plans and recommendations
intended_agent_role: "CA Agent (owns post-sales adoption)"
secondary_agents: ["SA Agent", "Delivery Agent", "VE Agent"]

primary_objective: "Guide customers through security solution adoption from initial deployment to optimized maturity, ensuring value realization at each stage"

when_not_to_use:
  - "Customer is in active pre-sales evaluation (use POV playbook)"
  - "Customer has already reached Optimized maturity"
  - "Customer purchased non-security solution"
  - "Account is in active churn process"

# ==============================================================================
# TRIGGER CONDITIONS
# ==============================================================================
trigger_conditions:
  automatic:
    - event: "SIG_LC_002"
      signal_filter: "solution_area == 'security'"
      description: "New security customer closed - initiate adoption journey"

    - event: "SIG_HLT_001"
      signal_filter: "health_score < 70 AND solution == 'security'"
      description: "Security health declining - assess adoption stage"

    - event: "adoption_milestone_due"
      description: "Scheduled adoption milestone approaching"
      timing: "7 days before milestone"

    - event: "quarterly_adoption_review"
      description: "Regular adoption progress assessment"
      timing: "Monthly"

  manual:
    - "CA requests adoption assessment"
    - "Customer requests enablement support"
    - "Expansion opportunity requires maturity assessment"
    - "Renewal preparation needs adoption story"

  conditional:
    - condition: "$.account.security_license_active AND $.adoption.stage == null"
      description: "Security customer without adoption stage tracking"

    - condition: "$.adoption.stage_age_days > 90 AND $.adoption.stage != 'optimized'"
      description: "Customer stuck at adoption stage for 90+ days"

# ==============================================================================
# REQUIRED INPUTS
# ==============================================================================
validation_inputs:
  mandatory:
    - artifact: "infohub/{realm}/{node}/overview.md"
      description: "Account overview"
    - artifact: "infohub/{realm}/{node}/installed_base.md"
      description: "Current products and ARR"

  optional:
    - artifact: "infohub/{realm}/{node}/success_plan/csp.yaml"
      use: "Success plan context and objectives"
    - artifact: "infohub/{realm}/{node}/success_plan/adoption_journey.yaml"
      use: "Current adoption status"
    - artifact: "infohub/{realm}/{node}/governance/health_score.yaml"
      use: "Health indicators"
    - artifact: "/api/v1/realms/{realm}/nodes/{node}/usage-metrics"
      use: "Usage and telemetry data"
    - artifact: "infohub/{realm}/{node}/stakeholders/relationship_map.md"
      use: "Stakeholder context"

  minimum_data_threshold:
    - "Account has active security license"
    - "Basic account information available"

# ==============================================================================
# MATURITY MODEL
# ==============================================================================
maturity_model:
  stages:
    - stage: "foundation"
      name: "Foundation"
      description: "Basic deployment with initial data ingestion"
      typical_duration: "0-30 days post go-live"
      success_criteria:
        - "Data ingestion active from 1+ sources"
        - "Basic dashboards created"
        - "At least 1 analyst using platform regularly"
        - "Initial use case documented"
      use_cases:
        - "Log management / centralized logging"
        - "Basic search and investigation"
        - "Initial compliance visibility"
      risks_at_stage:
        - "Data not flowing properly"
        - "Users not logging in"
        - "No clear owner assigned"

    - stage: "operational"
      name: "Operational"
      description: "Active detection and response operations"
      typical_duration: "30-90 days"
      prerequisites:
        - "Foundation criteria met"
        - "SOC team engaged"
      success_criteria:
        - "Detection rules active (20+ rules)"
        - "Alerting configured and tuned"
        - "MTTD measurable and tracked"
        - "SOC integrated into workflow"
        - "Investigation workflows established"
      use_cases:
        - "Detection engineering"
        - "Alert triage and investigation"
        - "Incident response"
        - "Threat detection"
      risks_at_stage:
        - "Alert fatigue from poor tuning"
        - "Integration gaps with existing tools"
        - "Insufficient training"

    - stage: "advanced"
      name: "Advanced"
      description: "Automation and advanced detection"
      typical_duration: "90-180 days"
      prerequisites:
        - "Operational criteria met"
        - "Dedicated security team"
      success_criteria:
        - "SOAR integration active"
        - "Custom detection rules created"
        - "Automation reducing manual effort 30%+"
        - "Metrics consistently improving"
        - "Multi-source correlation active"
      use_cases:
        - "Automated response"
        - "Advanced threat detection"
        - "Custom detection development"
        - "Cross-source correlation"
      risks_at_stage:
        - "Complexity overwhelming team"
        - "Automation without proper testing"
        - "Skill gaps in advanced features"

    - stage: "optimized"
      name: "Optimized"
      description: "Full XDR with proactive threat hunting"
      typical_duration: "180+ days"
      prerequisites:
        - "Advanced criteria met"
        - "Mature security program"
      success_criteria:
        - "Full endpoint visibility (EDR active)"
        - "Proactive threat hunting program"
        - "Reference customer potential"
        - "Expanding to new use cases"
        - "Business metrics tied to security outcomes"
      use_cases:
        - "Threat hunting"
        - "XDR / unified security"
        - "Proactive defense"
        - "Security analytics"
      expansion_opportunities:
        - "Cloud security"
        - "Additional data sources"
        - "New business units"
        - "Observability cross-sell"

# ==============================================================================
# KEY QUESTIONS
# ==============================================================================
key_questions:
  stage_assessment:
    - "What data sources are currently ingesting?"
    - "How many detection rules are active?"
    - "What is the current MTTD/MTTR?"
    - "How many analysts are using the platform daily?"
    - "What automation is in place?"
    - "Are custom detections being developed?"

  foundation_stage:
    - "Is data flowing from primary sources?"
    - "Have initial dashboards been created?"
    - "Who is the designated platform owner?"
    - "What use case is the initial focus?"
    - "Has basic training been completed?"

  operational_stage:
    - "How many detection rules are active and tuned?"
    - "What is the alert volume and false positive rate?"
    - "How is the SOC team using the platform?"
    - "What integrations are needed?"
    - "Is MTTD being measured and tracked?"

  advanced_stage:
    - "What SOAR/automation is integrated?"
    - "Are custom detection rules being developed?"
    - "What efficiency gains have been achieved?"
    - "How is multi-source correlation being used?"
    - "What skills gaps exist for advanced features?"

  optimized_stage:
    - "Is threat hunting happening proactively?"
    - "What business metrics are tied to security?"
    - "What expansion opportunities exist?"
    - "Would they be a reference customer?"
    - "What emerging use cases interest them?"

  blocker_identification:
    - "What is preventing progress to the next stage?"
    - "What resources are lacking?"
    - "What technical challenges exist?"
    - "What organizational barriers exist?"
    - "What training or enablement is needed?"

# ==============================================================================
# DECISION LOGIC
# ==============================================================================
decision_logic:
  rules:
    # Stage Assessment Rules
    - id: "assess_foundation"
      condition: "adoption_stage == null OR adoption_stage == 'foundation'"
      severity: "MEDIUM"
      output_type: "Assessment + Recommendations"
      decision:
        title: "Foundation Stage Assessment for {node}"
        context: "Assessing readiness to progress from Foundation to Operational"
        recommendation: "Evaluate foundation criteria completion"
        actions:
          - "Verify data ingestion is active and healthy"
          - "Confirm initial dashboards are in use"
          - "Identify platform owner and daily users"
          - "Document current use cases"
        stakeholders: ["CA", "Technical Champion"]

    - id: "foundation_stuck"
      condition: "adoption_stage == 'foundation' AND stage_age_days > 45"
      severity: "HIGH"
      output_type: "Risk + Action Items"
      decision:
        title: "Foundation adoption stalled for {node}"
        context: "Customer has been in Foundation stage for 45+ days without progression"
        recommendation: "Execute Five Whys to identify blockers and create acceleration plan"
        actions:
          - "Schedule technical health check"
          - "Review data ingestion status"
          - "Assess user adoption and training needs"
          - "Create 30-day acceleration plan"
        urgency: "HIGH"
      creates:
        - object_type: "Risk"
          category: "adoption"
          severity: "HIGH"

    - id: "ready_for_operational"
      condition: "adoption_stage == 'foundation' AND foundation_criteria_met >= 0.8"
      severity: "LOW"
      output_type: "Initiative"
      decision:
        title: "Ready for Operational stage - {node}"
        context: "Foundation criteria substantially met"
        recommendation: "Initiate Operational stage adoption"
        actions:
          - "Create Operational stage enablement plan"
          - "Schedule detection rule workshop"
          - "Define MTTD baseline"
          - "Plan SOC integration"

    - id: "operational_stuck"
      condition: "adoption_stage == 'operational' AND stage_age_days > 90"
      severity: "MEDIUM"
      output_type: "Assessment + Action Items"
      decision:
        title: "Operational adoption plateau for {node}"
        context: "Customer in Operational stage for 90+ days"
        recommendation: "Assess readiness for Advanced features"
        actions:
          - "Review automation opportunities"
          - "Assess skill gaps for advanced features"
          - "Evaluate SOAR integration options"
          - "Create Advanced stage readiness plan"

    - id: "low_usage_alert"
      condition: "daily_active_users < expected_users * 0.5"
      severity: "HIGH"
      output_type: "Risk + Action Items"
      decision:
        title: "Low usage detected for {node} security deployment"
        context: "Usage metrics significantly below expectations"
        recommendation: "Execute user adoption intervention"
        actions:
          - "Identify barriers to adoption"
          - "Schedule user training session"
          - "Review workflow integration"
          - "Create user adoption plan"
        urgency: "HIGH"
      creates:
        - object_type: "Risk"
          category: "adoption"
          severity: "HIGH"

    - id: "optimized_expansion"
      condition: "adoption_stage == 'optimized' AND expansion_signals.count > 0"
      severity: "LOW"
      output_type: "Opportunity"
      decision:
        title: "Expansion opportunity for optimized account {node}"
        context: "Optimized customer showing expansion signals"
        recommendation: "Pursue expansion conversation"
        actions:
          - "Document current value delivered"
          - "Identify expansion use cases"
          - "Engage AE for expansion opportunity"
          - "Prepare expansion business case"

# ==============================================================================
# ENABLEMENT ACTIVITIES
# ==============================================================================
enablement_activities:
  foundation:
    - activity: "Data Onboarding Workshop"
      duration: "2 hours"
      owner: "CA/SA"
      outcome: "Primary data sources ingesting"

    - activity: "Dashboard Creation Session"
      duration: "2 hours"
      owner: "CA"
      outcome: "Initial dashboards deployed"

    - activity: "User Training - Basics"
      duration: "Half day"
      owner: "CA/Training"
      outcome: "Users proficient in basic operations"

  operational:
    - activity: "Detection Rule Workshop"
      duration: "Half day"
      owner: "SA/CA"
      outcome: "Detection rules deployed and tuned"

    - activity: "Alert Management Training"
      duration: "2 hours"
      owner: "CA"
      outcome: "Alert triage workflow established"

    - activity: "SOC Integration Session"
      duration: "2-4 hours"
      owner: "SA"
      outcome: "Platform integrated with SOC workflow"

  advanced:
    - activity: "SOAR Integration Workshop"
      duration: "Full day"
      owner: "SA/PS"
      outcome: "Automation workflows active"

    - activity: "Custom Detection Development"
      duration: "Half day"
      owner: "SA"
      outcome: "Team capable of custom rule creation"

    - activity: "Advanced Analytics Training"
      duration: "Half day"
      owner: "SA/Training"
      outcome: "Team using advanced features"

  optimized:
    - activity: "Threat Hunting Workshop"
      duration: "Full day"
      owner: "SA/Security Specialist"
      outcome: "Threat hunting program initiated"

    - activity: "XDR Strategy Session"
      duration: "2 hours"
      owner: "SA"
      outcome: "XDR roadmap defined"

    - activity: "Value Realization Review"
      duration: "2 hours"
      owner: "VE"
      outcome: "Business value documented"

# ==============================================================================
# EXPECTED OUTPUTS
# ==============================================================================
expected_outputs:
  primary_artifact:
    path: "infohub/{realm}/{node}/success_plan/adoption_journey.yaml"
    format: "yaml"
    sections:
      - current_assessment
      - stage_progression
      - enablement_plan
      - blockers
      - next_steps

    schema:
      current_assessment:
        - current_stage: "enum[foundation|operational|advanced|optimized]"
        - stage_entry_date: "date"
        - days_in_stage: "integer"
        - criteria_met: "array[criterion]"
        - criteria_pending: "array[criterion]"
        - health_score: "integer"

      stage_progression:
        - target_stage: "enum[operational|advanced|optimized]"
        - target_date: "date"
        - gap_analysis: "array[gap]"
        - readiness_score: "percentage"

      enablement_plan:
        type: "array"
        items:
          activity: "string"
          scheduled_date: "date"
          owner: "string"
          status: "enum[scheduled|completed|cancelled]"

      blockers:
        type: "array"
        items:
          blocker: "string"
          category: "enum[technical|resource|skill|organizational]"
          resolution_plan: "string"
          owner: "string"

  action_items:
    path: "infohub/{realm}/{node}/actions/"
    create_for_each: "enablement activity and blocker resolution"

  notifications:
    - recipient: "SA Agent"
      condition: "enablement_activity.type == 'technical'"
      message: "Technical enablement requested for {node}"

    - recipient: "VE Agent"
      condition: "stage == 'optimized'"
      message: "Value documentation needed for optimized account {node}"

    - recipient: "AE Agent"
      condition: "expansion_opportunity_identified"
      message: "Expansion opportunity at {node} - adoption stage: optimized"

# ==============================================================================
# STOP CONDITIONS
# ==============================================================================
stop_conditions:
  escalate_to_human:
    - condition: "blockers_unresolved > 3"
      reason: "Multiple unresolved adoption blockers"
      action: "CA Manager review needed"

    - condition: "stage_regression"
      reason: "Customer regressing to earlier stage"
      action: "Executive intervention required"

    - condition: "technical_blocker_unresolved_30_days"
      reason: "Technical issue blocking adoption"
      action: "Escalate to Support/PS leadership"

  insufficient_data:
    - "No usage telemetry available"
    - "Customer not responding to outreach"
    - "No technical contact identified"

  ambiguity_signals:
    - "Customer priorities unclear"
    - "Organizational changes affecting ownership"
    - "Budget uncertainty for enablement"

# ==============================================================================
# VALIDATION CHECKS
# ==============================================================================
validation_checks:
  pre_execution:
    - "Account has active security license"
    - "Primary contact information available"
    - "Some usage data available or expected"

  post_execution:
    - "Current stage accurately assessed"
    - "Criteria completion verified"
    - "Blockers identified and categorized"
    - "Next stage progression plan created"
    - "Enablement activities scheduled"

  output_quality:
    - "Assessment based on data, not assumptions"
    - "Blockers have resolution plans"
    - "Enablement activities have owners"
    - "Target dates are realistic"

# ==============================================================================
# INTEGRATION WITH OTHER PLAYBOOKS
# ==============================================================================
integrates_with:
  - playbook: "PB_501_five_whys_analysis"
    integration: "Use for root cause analysis of adoption blockers"
    trigger: "Blocker persists for 30+ days"

  - playbook: "PB_CS_301_health_triage"
    integration: "Health decline may indicate adoption issues"
    trigger: "Health score drops during adoption"

  - playbook: "PB_CS_203_executive_review"
    integration: "Adoption progress is EBR topic"
    trigger: "Quarterly EBR preparation"

  - playbook: "PB_301_value_engineering"
    integration: "Value quantification at each stage"
    trigger: "Stage completion"

# ==============================================================================
# EXECUTION METADATA
# ==============================================================================
estimated_execution_time: "30-60 minutes per assessment"
frequency: "Monthly or on trigger"
human_review_required: true
approval_workflow:
  - reviewer: "CA"
    approval_gate: "Validate stage assessment and plan"
  - reviewer: "Technical Champion"
    approval_gate: "Confirm technical readiness and priorities"

last_updated: "2026-01-21"
version: "1.0"
status: "production_ready"
notes: "Security-specific stage adoption playbook - adapt for Observability and Search"

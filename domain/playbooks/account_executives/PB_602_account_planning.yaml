# PLAYBOOK: Strategic Account Planning with Five Whys
# Framework operationalization for AI agents
# Combines account planning with root cause analysis for blockers

# ==============================================================================
# PLAYBOOK METADATA
# ==============================================================================
framework_name: "Strategic Account Planning"
framework_source: "Enterprise Sales Best Practices + Five Whys Analysis"
playbook_mode: "GENERATIVE"  # Generates strategic account plans
playbook_category: "pursuit_sales_support"
intended_agent_role: "AE Agent (coordinates planning)"
secondary_agents: ["SA Agent", "CI Agent", "CA Agent", "Governance Agent"]

primary_objective: "Create comprehensive strategic account plan, identify growth opportunities, address blockers through root cause analysis, and define execution roadmap"

when_not_to_use:
  - "Account in early discovery (insufficient context)"
  - "Transactional account (not strategic)"
  - "Account data significantly outdated (> 90 days)"
  - "Key stakeholder relationships not established"

# ==============================================================================
# TRIGGER CONDITIONS
# ==============================================================================
trigger_conditions:
  automatic:
    - event: "annual_planning_cycle"
      description: "Annual account planning cycle begins"
      timing: "Q4 each year"

    - event: "SIG_LC_003"
      signal_filter: "new_mode == 'renewal'"
      description: "Account entering renewal phase requires planning refresh"

    - event: "executive_sponsor_change"
      description: "New executive sponsor assigned - refresh account strategy"

    - event: "SIG_TECH_001"
      signal_filter: "ring_changes_count >= 5"
      description: "Significant technology landscape shift in account"

    - event: "health_score_threshold"
      description: "Health score dropped below 50 - strategic intervention needed"
      condition: "$.health_score.current < 50"

  manual:
    - "Sales leadership requests account plan"
    - "QBR planning requires strategic refresh"
    - "New fiscal year planning cycle"
    - "Major expansion opportunity identified"

  conditional:
    - condition: "$.account.arr >= ${thresholds.strategic_account_arr}"
      description: "Strategic account threshold crossed"

    - condition: "$.account.days_since_plan_update >= 180"
      description: "Account plan more than 6 months old"

# ==============================================================================
# REQUIRED INPUTS
# ==============================================================================
validation_inputs:
  mandatory:
    - artifact: "{realm}/{node}/external-infohub/overview.md"
      description: "Account overview"
    - artifact: "{realm}/{node}/external-infohub/installed_base.md"
      description: "Current products and ARR"
    - artifact: "{realm}/{node}/internal-infohub/stakeholders/relationship_map.md"
      description: "Stakeholder landscape"

  optional:
    - artifact: "{realm}/{node}/internal-infohub/risks/*.md"
      use: "Current risks to address"
    - artifact: "{realm}/{node}/internal-infohub/competitive/*.md"
      use: "Competitive context"
    - artifact: "{realm}/{node}/external-infohub/decisions/*.md"
      use: "Historical decisions"
    - artifact: "{realm}/{node}/external-infohub/retrospectives/*.md"
      use: "Past win/loss learnings"
    - artifact: "{realm}/intelligence/technology_scout/current_map.yaml"
      use: "Technology trends for opportunity identification"
    - artifact: "/api/v1/realms/{realm}/tech-signal-map/skills-gap"
      use: "Skills gap opportunities"
    - artifact: "{realm}/{node}/internal-infohub/governance/health_score.yaml"
      use: "Current account health"
    - artifact: "Previous account plan"
      use: "Historical strategy and outcomes"

  minimum_data_threshold:
    - "Account overview exists"
    - "Current ARR/installed base known"
    - "At least 3 stakeholders identified"

# ==============================================================================
# KEY QUESTIONS
# ==============================================================================
key_questions:
  current_state_assessment:
    - "What is the current account health and ARR?"
    - "What products/solutions are deployed?"
    - "Who are our key stakeholders and champions?"
    - "What is the competitive landscape?"
    - "What active opportunities exist?"
    - "What risks are currently tracked?"

  opportunity_identification:
    - "What whitespace exists for expansion?"
    - "What customer initiatives align with our capabilities?"
    - "What technology trends create new opportunities?"
    - "What adjacent teams or business units could we expand to?"
    - "What renewal or upgrade opportunities exist?"
    - "What cross-sell/upsell potential exists?"

  blocker_analysis:
    - "What is preventing us from achieving account potential?"
    - "What recurring issues affect this account?"
    - "What relationship gaps exist?"
    - "What competitive threats are active?"
    - "What internal resource constraints affect execution?"

  # FIVE WHYS FOR BLOCKER ANALYSIS
  five_whys_for_blockers:
    purpose: "Understand root cause of account blockers to enable effective resolution"

    growth_blockers:
      - "Why isn't this account growing as expected? (1st why)"
      - "Why hasn't that opportunity materialized? (2nd why)"
      - "Why haven't we engaged the right stakeholders? (3rd why)"
      - "Why don't we have the access/relationships needed? (4th why)"
      - "What systematic gap allows this blocker to persist? (5th why)"

    relationship_blockers:
      - "Why is our relationship strength declining? (1st why)"
      - "Why aren't stakeholders engaged? (2nd why)"
      - "Why aren't we providing enough value touchpoints? (3rd why)"
      - "Why don't we have a structured engagement plan? (4th why)"
      - "What systematic issue prevents consistent engagement? (5th why)"

    competitive_blockers:
      - "Why is the competitor gaining ground? (1st why)"
      - "Why is their message resonating? (2nd why)"
      - "Why aren't we countering effectively? (3rd why)"
      - "Why don't we have the right positioning/proof points? (4th why)"
      - "What systematic competitive gap needs addressing? (5th why)"

    technical_blockers:
      - "Why isn't the customer seeing expected value? (1st why)"
      - "Why hasn't the deployment succeeded as planned? (2nd why)"
      - "Why didn't we anticipate these challenges? (3rd why)"
      - "Why wasn't our technical approach sufficient? (4th why)"
      - "What systematic technical gap needs addressing? (5th why)"

  strategy_formulation:
    - "What is our vision for this account in 1-3 years?"
    - "What are the priority initiatives for this planning period?"
    - "What resources do we need to achieve our goals?"
    - "What milestones will indicate we're on track?"
    - "How will we measure success?"

# ==============================================================================
# DECISION LOGIC
# ==============================================================================
decision_logic:
  rules:
    # High potential account with identified blockers
    - id: "high_potential_blocked"
      condition: "account.potential == 'HIGH' AND blockers.count >= 2"
      severity: "HIGH"
      output_type: "Initiative + Action Items"
      decision:
        title: "Strategic intervention needed for high-potential account {node}"
        context: "Multiple blockers preventing realization of account potential"
        recommendation: "Apply Five Whys to understand root causes and develop targeted interventions"
        actions:
          - "Execute Five Whys analysis on each blocker"
          - "Create targeted action plan addressing root causes"
          - "Request additional resources if needed"
          - "Establish weekly review cadence"
        stakeholders: ["AE", "SA", "Sales Leadership"]
        urgency: "HIGH"

    # Technology opportunity from signal map
    - id: "tech_opportunity_alignment"
      condition: "technology_scout.opportunities.count > 0 AND alignment == 'strong'"
      severity: "MEDIUM"
      output_type: "Initiative"
      decision:
        title: "Technology opportunity identified: {opportunity_summary}"
        context: "Technology Scout shows customer investing in areas aligned with our offerings"
        recommendation: "Create initiative to capitalize on technology alignment"
        actions:
          - "SA: Prepare positioning for {technology} initiative"
          - "AE: Schedule discovery with relevant stakeholders"
          - "Develop value proposition specific to their tech direction"

    # Competitive threat requires response
    - id: "competitive_threat_response"
      condition: "competitive_threat.severity == 'HIGH'"
      severity: "HIGH"
      output_type: "Risk + Initiative"
      decision:
        title: "Competitive threat from {competitor} requires response"
        context: "Competitor actively threatening position in account"
        recommendation: "Execute competitive response plan"
        actions:
          - "CI Agent: Generate updated battlecard"
          - "SA: Prepare technical differentiation"
          - "AE: Reinforce champion relationships"
          - "Schedule value reinforcement meeting"
      creates:
        - object_type: "Risk"
          category: "competitive"
          severity: "HIGH"

    # Relationship gap identified
    - id: "relationship_gap"
      condition: "stakeholder_gaps.count >= 2"
      severity: "MEDIUM"
      output_type: "Initiative + Action Items"
      decision:
        title: "Relationship gaps in {node} - expand stakeholder coverage"
        context: "Key stakeholders not engaged or relationship strength declining"
        recommendation: "Execute relationship building plan"
        actions:
          - "Map missing stakeholder coverage"
          - "Develop engagement strategy per stakeholder"
          - "Request executive sponsorship if needed"
          - "Schedule introductions through champions"

    # Renewal at risk
    - id: "renewal_risk"
      condition: "renewal.months_away <= 6 AND health_score < 70"
      severity: "HIGH"
      output_type: "Risk + Initiative"
      decision:
        title: "Renewal at risk for {node} - immediate intervention"
        context: "Low health score with renewal approaching"
        recommendation: "Execute retention playbook"
        actions:
          - "Apply Five Whys to understand health decline root cause"
          - "Address immediate concerns"
          - "Schedule executive engagement"
          - "Develop retention offer if needed"
        urgency: "IMMEDIATE"
      creates:
        - object_type: "Risk"
          category: "commercial"
          severity: "HIGH"

# ==============================================================================
# FIVE WHYS FOR ACCOUNT PLANNING
# ==============================================================================
five_whys_methodology:
  application_in_planning:
    description: "Use Five Whys to analyze persistent blockers preventing account growth"

    blocker_categories:
      - category: "growth_stall"
        symptoms:
          - "Account ARR flat for 2+ years"
          - "No new opportunities created"
          - "Whitespace not converted"
        five_whys_focus: "Why aren't we expanding?"

      - category: "relationship_decline"
        symptoms:
          - "Champion left or disengaged"
          - "Meeting frequency declining"
          - "Stakeholder access limited"
        five_whys_focus: "Why are relationships weakening?"

      - category: "competitive_pressure"
        symptoms:
          - "Competitor mentioned in meetings"
          - "Budget shifted to competitor"
          - "RFP includes competitor requirements"
        five_whys_focus: "Why is competitor gaining ground?"

      - category: "value_realization"
        symptoms:
          - "Customer not achieving expected outcomes"
          - "Usage metrics below targets"
          - "Expansion conversations stalled"
        five_whys_focus: "Why isn't customer seeing full value?"

  integration_with_planning:
    timing: "Execute Five Whys for each significant blocker before strategy formulation"
    output: "Root cause analysis feeds into initiative design"
    validation: "Ensure strategies address root causes, not symptoms"

  example:
    blocker: "Account hasn't expanded in 18 months despite high potential"
    why_1: "No new opportunities have been created"
    why_2: "We don't have access to decision makers in other business units"
    why_3: "Our champion is in IT and doesn't have relationships with business leaders"
    why_4: "We've relied on single champion instead of building broader relationships"
    why_5: "Our engagement model focuses on technical users, not business stakeholders"
    root_cause: "Engagement model gap - need business stakeholder coverage"
    strategic_action: "Develop business stakeholder engagement plan with executive sponsorship"

# ==============================================================================
# EXPECTED OUTPUTS
# ==============================================================================
expected_outputs:
  primary_artifact:
    path: "{realm}/{node}/external-infohub/planning/account_plan_{YYYY}.md"
    format: "markdown"
    sections:
      - executive_summary
      - account_overview
      - opportunity_analysis
      - blocker_analysis_with_five_whys
      - strategic_priorities
      - execution_roadmap
      - success_metrics
      - resource_requirements

    schema:
      executive_summary:
        - account_name: "string"
        - current_arr: "number"
        - target_arr: "number"
        - growth_percentage: "number"
        - key_priorities: "array[string]"
        - primary_blocker_root_cause: "string"

      account_overview:
        - health_score: "integer"
        - installed_products: "array[string]"
        - key_stakeholders: "array[stakeholder]"
        - champion_strength: "enum[STRONG|MODERATE|WEAK|NONE]"
        - competitive_presence: "array[competitor]"

      opportunity_analysis:
        - whitespace_opportunities: "array[opportunity]"
        - technology_scout_opportunities: "array[opportunity]"
        - cross_sell_upsell: "array[opportunity]"
        - total_addressable_opportunity: "number"

      blocker_analysis_with_five_whys:
        type: "array"
        items:
          blocker: "string"
          category: "enum[growth|relationship|competitive|technical|resource]"
          five_whys_chain: "array[why_level]"
          root_cause: "string"
          controllable: "boolean"
          strategic_response: "string"

      strategic_priorities:
        - horizon_1: "array[priority] (0-6 months)"
        - horizon_2: "array[priority] (6-12 months)"
        - horizon_3: "array[priority] (12+ months)"

      execution_roadmap:
        - quarter: "string"
        - initiatives: "array[initiative]"
        - milestones: "array[milestone]"
        - owner: "string"

      success_metrics:
        - metric: "string"
        - current_value: "string"
        - target_value: "string"
        - measurement_frequency: "string"

      resource_requirements:
        - resource: "string"
        - justification: "string"
        - urgency: "enum[IMMEDIATE|NEAR_TERM|FUTURE]"

  action_items:
    path: "{realm}/{node}/internal-infohub/actions/"
    create_for_each: "strategic priority action"

  risk_objects:
    path: "{realm}/{node}/internal-infohub/risks/"
    create_if: "blockers with uncontrollable root causes"

  notifications:
    - recipient: "Sales Leadership"
      condition: "account.type == 'strategic'"
      message: "Account plan complete for {node}: Target ${target_arr} ({growth_percentage}% growth)"

    - recipient: "SA Agent"
      condition: "technical_initiatives.count > 0"
      message: "Technical initiatives identified for {node} planning"

    - recipient: "CI Agent"
      condition: "competitive_threats.count > 0"
      message: "Competitive response needed for {node}"

# ==============================================================================
# STOP CONDITIONS
# ==============================================================================
stop_conditions:
  escalate_to_human:
    - condition: "resource_request_significant"
      reason: "Plan requires significant resource allocation"
      action: "Leadership approval needed for resource commitment"

    - condition: "strategic_pivot_required"
      reason: "Analysis suggests major strategy change"
      action: "Executive discussion needed for strategic direction"

    - condition: "multiple_unresolved_root_causes"
      reason: "Five Whys analysis reveals complex, interconnected issues"
      action: "Facilitated planning session needed"

  insufficient_data:
    - "No current account overview"
    - "Key stakeholders not identified"
    - "No historical engagement data"

  ambiguity_signals:
    - "Conflicting priorities from different stakeholders"
    - "Unclear customer strategic direction"
    - "Uncertain competitive landscape"

# ==============================================================================
# VALIDATION CHECKS
# ==============================================================================
validation_checks:
  pre_execution:
    - "Account overview exists and is current (<90 days)"
    - "Stakeholder map available"
    - "Current ARR/installed base known"

  post_execution:
    - "At least 3 strategic priorities defined"
    - "All significant blockers analyzed with Five Whys"
    - "Root causes identified for each blocker"
    - "Execution roadmap spans at least 2 quarters"
    - "Success metrics defined and measurable"

  output_quality:
    - "Priorities address root causes, not symptoms"
    - "Resource requests justified by analysis"
    - "Milestones are specific and timebound"
    - "Plan is actionable, not generic"

# ==============================================================================
# INTEGRATION WITH OTHER PLAYBOOKS
# ==============================================================================
integrates_with:
  - playbook: "PB_105_five_whys_analysis"
    integration: "Uses Five Whys for blocker root cause analysis"
    provides: "Root cause context for strategic planning"

  - playbook: "PB_201_swot_analysis"
    integration: "SWOT provides input for opportunity and threat analysis"
    provides: "Strategic positioning context"

  - playbook: "PB_001_three_horizons"
    integration: "Three Horizons framework for prioritization"
    provides: "Time-based priority framework"

  - playbook: "PB_601_retrospective"
    integration: "Past retrospectives inform planning"
    provides: "Historical learnings and patterns"

# ==============================================================================
# EXECUTION METADATA
# ==============================================================================
estimated_execution_time: "45-90 minutes (agent) + stakeholder input"
frequency: "Annual with quarterly refreshes"
human_review_required: true
approval_workflow:
  - reviewer: "AE"
    approval_gate: "Validate strategy and priorities"
  - reviewer: "SA"
    approval_gate: "Validate technical initiatives"
  - reviewer: "Sales Leadership"
    condition: "account.type == 'strategic'"
    approval_gate: "Approve resource allocation and strategic direction"

last_updated: "2026-01-21"
version: "1.0"
status: "production_ready"
notes: "Integrates Five Whys methodology for analyzing and resolving account blockers"

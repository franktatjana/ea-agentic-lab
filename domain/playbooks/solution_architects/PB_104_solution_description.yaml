# PLAYBOOK: High-Level Solution Description
# Framework operationalization for AI agents

# ==============================================================================
# PLAYBOOK METADATA
# ==============================================================================
framework_name: "High-Level Solution Description (HLD)"
framework_source: "Enterprise Architecture / TOGAF Solution Building Blocks"
intended_agent_role: "SA Agent (Solution Architect)"
secondary_agents: ["Specialist provides domain-specific architecture patterns", "CA Agent uses HLD for customer onboarding and adoption planning"]

primary_objective: "Produce a customer-facing solution description that communicates architecture decisions, component interactions, deployment topology, and integration points without exposing vendor-internal or commercial details"

vault_routing:
  primary_vault: "Customer InfoHub"
  rationale: "The solution description is the core customer-facing architecture artifact. It documents what was designed, why, and how components fit together. The customer keeps this as their solution knowledge base."
  secondary_outputs:
    - vault: "Internal Account Hub"
      artifact: "Internal architecture notes with competitive positioning, pricing rationale, and candid technical risks"
    - vault: "Global Knowledge Vault"
      artifact: "Anonymized solution patterns and architecture templates (after engagement closes)"

when_not_to_use:
  - "No architecture decisions made yet (complete technical discovery first)"
  - "Customer only needs a product datasheet, not a solution description"
  - "POC scope only (POC plan covers its own architecture, see PB_501_poc_success_plan)"
  - "Customer has their own architecture documentation and does not want vendor-authored HLD"

# ==============================================================================
# TRIGGER CONDITIONS
# ==============================================================================
trigger_conditions:
  automatic:
    - "Architecture decisions (ADRs) reach threshold (3+ decisions documented)"
    - "Deployment model decided and sizing completed"
    - "Customer requests 'architecture overview' or 'solution summary'"
    - "Pre-sales to post-sales handover approaching (HLD needed for CA)"
    - "Quarterly business review requires architecture refresh"

  manual:
    - "SA explicitly creates description: '/solution describe {scope}'"
    - "Customer architect requests architecture documentation for internal stakeholders"
    - "Delivery team needs solution context for implementation"

  conditional:
    - "IF adr_count >= 3 AND deployment_model_decided THEN trigger"
    - "IF handover_to_postsales_imminent AND no_hld_exists THEN trigger"
    - "IF customer_onboarding_starting AND no_hld_exists THEN trigger"

# ==============================================================================
# REQUIRED INPUTS
# ==============================================================================
required_inputs:
  mandatory:
    - artifact: "Architecture Decision Records (ADRs) from PB_101"
    - artifact: "Use case definitions with business objectives"
    - artifact: "Deployment model (cloud, on-prem, hybrid)"

  optional:
    - artifact: "Sizing estimation from PB_102"
      use: "Include capacity summary (non-commercial portions only)"
    - artifact: "Integration specifications"
      use: "Document data flows and integration points"
    - artifact: "Security and compliance requirements"
      use: "Include security architecture decisions"
    - artifact: "POC results and learnings"
      use: "Incorporate validated patterns from POC"
    - artifact: "Customer's existing architecture diagrams"
      use: "Show how solution fits within customer's landscape"

  minimum_data_threshold:
    - "At least one use case with architecture decisions"
    - "Deployment model decided"

# ==============================================================================
# KEY QUESTIONS TO EXTRACT
# ==============================================================================
key_questions:
  solution_overview:
    - "What business problem does this solution address?"
    - "What are the primary use cases and their priority?"
    - "Who are the users of this solution (roles, teams, regions)?"
    - "What is the expected value or outcome?"

  architecture:
    - "What are the major components and how do they interact?"
    - "What is the data flow from source to consumer?"
    - "What is the deployment topology (single site, multi-region, hybrid)?"
    - "What integration points exist with customer systems?"
    - "What are the key architecture decisions and their rationale?"

  non_functional:
    - "What are the performance characteristics (latency, throughput)?"
    - "What is the availability model (SLA, failover, DR)?"
    - "What security controls are in place (encryption, access, audit)?"
    - "What is the scalability approach (horizontal, vertical, elastic)?"

  operational:
    - "How is the solution monitored and maintained?"
    - "What is the upgrade and patching strategy?"
    - "What are the operational roles and responsibilities?"

# ==============================================================================
# DECISION LOGIC
# ==============================================================================
decision_logic:
  rules:
    - condition: "single_use_case AND straightforward_architecture"
      output_type: "Solution Description (concise)"
      decision: |
        CREATE Solution Description:
          scope: "Single use case"
          format: "Concise (5-10 pages)"
          sections: [overview, architecture, data flow, deployment, operations]

    - condition: "multiple_use_cases OR complex_architecture"
      output_type: "Solution Description (comprehensive)"
      decision: |
        CREATE Solution Description:
          scope: "Multi-use-case platform"
          format: "Comprehensive (10-20 pages)"
          sections: [overview, use cases, architecture, data flow, integration, security, deployment, operations, roadmap]

    - condition: "architecture_evolving OR incremental_delivery"
      output_type: "Solution Description (versioned)"
      decision: |
        CREATE Solution Description:
          scope: "Current state + planned evolution"
          version: "{major}.{minor}"
          sections: [current architecture, planned changes, migration path]
          note: "Mark sections as 'current' vs 'planned' clearly"

# ==============================================================================
# EXPECTED OUTPUTS
# ==============================================================================
expected_outputs:
  primary_artifact:
    path: "{realm}/{node}/external-infohub/architecture/solution_description.md"
    vault_type: "customer"
    format: "markdown"
    sections:
      - document_header
      - executive_summary
      - business_context
      - solution_overview
      - architecture_components
      - data_flow
      - integration_points
      - deployment_topology
      - security_architecture
      - operational_model
      - appendices

    schema:
      document_header:
        title: "string"
        version: "string (e.g., '1.0')"
        date: "YYYY-MM-DD"
        author: "string (SA role, not internal name)"
        audience: "string (e.g., 'Customer technical and business stakeholders')"
        status: "enum[DRAFT|REVIEW|APPROVED]"

      executive_summary: "string (1-2 paragraphs: what the solution does, key design principles)"

      business_context:
        problem_statement: "string"
        use_cases: "array[{name, description, priority}]"
        success_criteria: "array[string]"

      architecture_components:
        - component: "string"
          role: "string (what it does in the solution)"
          technology: "string (product or service)"
          interactions: "array[string] (which other components it connects to)"

      data_flow:
        description: "string (narrative of data journey)"
        sources: "array[string]"
        processing: "array[string]"
        outputs: "array[string]"
        diagram_reference: "string (path to diagram if available)"

      deployment_topology:
        model: "enum[CLOUD|ON_PREM|HYBRID]"
        regions: "array[string]"
        availability: "string (HA approach)"
        capacity_summary: "string (from sizing, non-commercial)"

      security_architecture:
        authentication: "string"
        authorization: "string"
        encryption: "string (at rest, in transit)"
        audit: "string"
        compliance: "array[string] (standards met)"

  internal_notes:
    path: "{realm}/{node}/internal-infohub/architecture_notes.md"
    vault_type: "internal"
    description: "Competitive positioning, technical risks not shared with customer, alternative approaches considered and rejected"

  architecture_diagrams:
    path: "{realm}/{node}/external-infohub/architecture/diagrams/"
    vault_type: "customer"
    description: "C4 model diagrams, data flow diagrams, deployment diagrams"
    action: "Flag for manual creation or update"

  notifications:
    - recipient: "CA Agent"
      condition: "always"
      message: "Solution description created/updated for {node}: ready for adoption planning"

    - recipient: "AE Agent"
      condition: "always"
      message: "Solution description available for {node}: can be shared with customer"

    - recipient: "Specialist"
      condition: "domain_review_needed == true"
      message: "Solution description for {node} needs {domain} specialist review"

# ==============================================================================
# STOP CONDITIONS
# ==============================================================================
stop_conditions:
  escalate_to_human:
    - condition: "no_architecture_decisions_exist"
      reason: "Cannot describe a solution that has not been designed"
      action: "SA to complete architecture decisions (PB_101) first"

    - condition: "customer_nda_or_classification_constraints"
      reason: "Customer restricts what can be documented externally"
      action: "SA to clarify documentation boundaries with customer"

    - condition: "architecture_actively_changing"
      reason: "Documenting a moving target produces misleading artifacts"
      action: "Wait for architecture to stabilize, or version the document clearly"

  insufficient_data:
    - "No ADRs or architecture decisions documented"
    - "Use cases not defined"
    - "Deployment model not decided"

  ambiguity_signals:
    - "Conflicting ADRs (superseded decisions not marked)"
    - "Multiple deployment models still under evaluation"
    - "Use case scope unclear (which use cases are in/out)"

  human_judgment_required:
    - "Determining appropriate level of detail for customer audience"
    - "Deciding what to include vs. exclude (customer-facing boundary)"
    - "Selecting diagram types and level of abstraction"

# ==============================================================================
# CONTENT GUARDRAILS
# ==============================================================================
content_guardrails:
  must_include:
    - "Business context (why this solution exists)"
    - "Architecture rationale (why this approach, not just what)"
    - "Integration points with customer systems"
    - "Operational model (who manages what)"

  must_exclude:
    - "Commercial information (pricing, license tiers, discounts)"
    - "Competitive positioning (why vendor X not competitor Y)"
    - "Internal risk assessments (candid gap analysis)"
    - "Intermediary decisions (internal deliberations before final choice)"
    - "Vendor-internal terminology or project codes"

  tone:
    - "Professional, objective, vendor-neutral language"
    - "Focus on customer outcomes, not product features"
    - "Architecture-first, not product-first"

# ==============================================================================
# VALIDATION CHECKS
# ==============================================================================
validation_checks:
  pre_execution:
    - "client_id exists in InfoHub"
    - "At least one ADR exists"
    - "Use cases defined with business objectives"

  post_execution:
    - "Document contains no commercial information"
    - "Document contains no competitive positioning"
    - "Document contains no internal risk assessments"
    - "All architecture decisions referenced have valid ADR IDs"
    - "Deployment topology matches sizing estimation"

  output_quality:
    - "No vendor-internal jargon without explanation"
    - "Architecture rationale explains 'why', not just 'what'"
    - "Diagrams referenced are available or flagged for creation"
    - "Version and date clearly stated"
    - "Document is self-contained (customer can read without vendor context)"

# ==============================================================================
# EXECUTION METADATA
# ==============================================================================
estimated_execution_time: "15-30 minutes (agent) + 30-60 minutes (human review and refinement)"
frequency: "Created once per engagement, versioned as architecture evolves"
human_review_required: true
approval_workflow:
  - reviewer: "SA Agent"
    approval_gate: "Validate technical accuracy and content guardrails"
  - reviewer: "Specialist"
    condition: "domain_specific_architecture == true"
    approval_gate: "Validate domain-specific architecture decisions"
  - reviewer: "AE Agent"
    approval_gate: "Confirm no commercial or competitive content leaks"

last_updated: "2026-02-09"
version: "1.0"
status: "stub"

# Security Deep Discovery Session Playbook
# Purpose: Conduct in-depth security discovery with customer security teams

id: "PB_SEC_009"
name: "Security Deep Discovery Session"
version: "1.0"
status: "ACTIVE"

metadata:
  category: "technical"
  framework: "Security Discovery"
  team_owner: "specialists"
  specialty: "security"
  description: "Deep technical discovery for security use cases with SOC teams, security architects, and CISOs"

raci:
  responsible:
    role: "security_specialist"
    agent: "security_specialist_agent"
  accountable:
    role: "sa_lead"
    human_required: true
  consulted:
    - role: "solution_architects"
    - role: "account_executives"
  informed:
    - role: "management"

triggers:
  - event: "security_discovery_requested"
  - event: "siem_replacement_opportunity"
  - event: "security_consolidation_initiative"

inputs:
  required:
    - name: "customer_id"
      type: "string"
    - name: "discovery_objectives"
      type: "list"
    - name: "customer_attendees"
      type: "list"
  optional:
    - name: "current_siem_platform"
    - name: "known_pain_points"
    - name: "compliance_requirements"

# Security-Specific Discovery Questions
discovery_framework:
  current_security_operations:
    questions:
      - "Walk me through your current SOC structure and team size"
      - "What's your current SIEM platform and how long have you had it?"
      - "How many detection rules do you have active today?"
      - "What's your average daily alert volume?"
      - "What's your current MTTD and MTTR?"
      - "What data sources are you ingesting today?"

  pain_points:
    questions:
      - "What are your top 3 frustrations with current security tooling?"
      - "Where are your biggest visibility gaps?"
      - "What keeps you up at night from a security perspective?"
      - "How much time does your team spend on tool maintenance vs. actual security work?"
      - "What's your experience with false positives?"

  detection_and_response:
    questions:
      - "Walk me through a typical investigation workflow"
      - "What threat frameworks do you align to (MITRE ATT&CK)?"
      - "How do you handle threat intelligence?"
      - "What automation/SOAR capabilities do you have?"
      - "How do you measure detection coverage?"

  data_and_scale:
    questions:
      - "What's your daily log volume (GB/day)?"
      - "What are your retention requirements?"
      - "Which data sources are critical vs. nice-to-have?"
      - "Any data sources you want but can't afford to ingest?"
      - "Cloud vs. on-prem infrastructure split?"

  compliance_and_governance:
    questions:
      - "What compliance frameworks apply (SOC2, HIPAA, PCI, etc.)?"
      - "Any specific audit requirements for logging?"
      - "Data residency requirements?"
      - "Who needs access to security data?"

  competitive_landscape:
    questions:
      - "What other solutions are you evaluating?"
      - "What drew you to those alternatives?"
      - "What would make you choose one over another?"

steps:
  - step_id: "pre_session_research"
    name: "Pre-Session Research"
    outputs: ["customer_security_profile"]
    research_areas:
      - "Customer industry security requirements"
      - "Known breaches or incidents (public)"
      - "Current security tool stack (from discovery)"
      - "Regulatory environment"

  - step_id: "conduct_discovery"
    name: "Conduct Security Discovery"
    outputs: ["discovery_notes"]
    session_structure:
      - phase: "SOC Overview (15 min)"
        focus: "Team, tools, processes"
      - phase: "Pain Points Deep Dive (20 min)"
        focus: "Current challenges and gaps"
      - phase: "Detection & Response (20 min)"
        focus: "Workflows, coverage, automation"
      - phase: "Data & Scale (15 min)"
        focus: "Volumes, sources, retention"
      - phase: "Requirements & Success (15 min)"
        focus: "What good looks like"

  - step_id: "analyze_findings"
    name: "Analyze Security Findings"
    outputs: ["security_assessment"]
    analysis_areas:
      - "Current maturity assessment"
      - "Gap identification"
      - "Quick wins identification"
      - "Migration complexity assessment"
      - "Competitive positioning"

  - step_id: "document_requirements"
    name: "Document Security Requirements"
    outputs: ["requirements_document"]

outputs:
  format: "markdown"
  storage_path: "infohub/{realm}/{node}/specialists/security/discovery_{date}.md"
  sections:
    - "Executive Summary"
    - "Current Security Operations"
    - "Pain Points & Gaps"
    - "Detection Requirements"
    - "Data Sources & Scale"
    - "Compliance Requirements"
    - "Success Criteria"
    - "Recommendations"
    - "Next Steps"

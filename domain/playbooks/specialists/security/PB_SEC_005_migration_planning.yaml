# SIEM Migration Planning Playbook
# Purpose: Plan and design migration from legacy SIEM platforms

id: "PB_SEC_005"
name: "SIEM Migration Planning"
version: "1.0"
status: "ACTIVE"

metadata:
  category: "technical"
  framework: "Migration Planning"
  team_owner: "specialists"
  specialty: "security"
  description: "Comprehensive migration planning from legacy SIEM to modern platform"

raci:
  responsible:
    role: "security_specialist"
    agent: "security_specialist_agent"
  accountable:
    role: "sa_lead"
    human_required: true
  consulted:
    - role: "professional_services"
      on_steps: ["effort_estimation", "resource_planning"]
    - role: "customer_architects"
      on_steps: ["current_state_assessment"]
  informed:
    - role: "account_executives"
    - role: "management"

triggers:
  - event: "migration_project_initiated"
  - event: "legacy_replacement_identified"

inputs:
  required:
    - name: "source_platform"
      type: "enum"
      options: ["LegacySIEM", "LegacySIEM2", "LegacySIEM3", "CloudSIEM", "other"]
    - name: "current_state_inventory"
      type: "object"
      description: "Inventory of rules, dashboards, integrations"
  optional:
    - name: "migration_timeline"
      type: "string"
    - name: "parallel_operation_required"
      type: "boolean"
    - name: "historical_data_requirements"
      type: "object"

steps:
  - step_id: "assess_current_state"
    name: "Assess Current State"
    action: "discovery"
    outputs: ["current_state_assessment"]
    inventory_items:
      - "Detection rules (count, complexity)"
      - "Correlation rules"
      - "Dashboards and reports"
      - "Data sources and integrations"
      - "Users and roles"
      - "Automated responses/playbooks"
      - "Custom parsers/normalizations"

  - step_id: "analyze_rules"
    name: "Analyze Detection Rules"
    action: "rule_analysis"
    outputs: ["rule_analysis"]
    categorization:
      migrate_as_is: "Direct conversion possible"
      migrate_with_changes: "Needs modification for target platform"
      redesign: "Should be rebuilt using modern approach"
      deprecate: "No longer needed or redundant"
      new_opportunity: "Gap that target platform can address better"

  - step_id: "data_source_mapping"
    name: "Map Data Sources"
    action: "data_mapping"
    outputs: ["data_source_map"]
    mapping:
      - "Source system"
      - "Current collection method"
      - "Target collection method"
      - "Schema changes required"
      - "Migration complexity"

  - step_id: "define_migration_strategy"
    name: "Define Migration Strategy"
    action: "strategy_definition"
    outputs: ["migration_strategy"]
    strategies:
      big_bang:
        description: "Complete cutover at single point"
        when: "Small environment, tight timeline, low risk tolerance"
      phased_parallel:
        description: "Run both systems, migrate in phases"
        when: "Large environment, high availability requirements"
      use_case_based:
        description: "Migrate by use case/capability"
        when: "Complex environment, need to show incremental value"

  - step_id: "create_phase_plan"
    name: "Create Phase Plan"
    action: "planning"
    outputs: ["phase_plan"]
    typical_phases:
      - phase: "Foundation"
        activities: ["Platform setup", "Core integrations", "User provisioning"]
      - phase: "Core Detection"
        activities: ["Priority rules migration", "Critical dashboards"]
      - phase: "Extended Coverage"
        activities: ["Remaining rules", "Advanced use cases"]
      - phase: "Optimization"
        activities: ["Tuning", "Performance optimization", "Training"]
      - phase: "Cutover"
        activities: ["Final validation", "Decommission legacy"]

  - step_id: "estimate_effort"
    name: "Estimate Effort & Resources"
    action: "estimation"
    outputs: ["effort_estimate"]
    estimation_factors:
      - "Rule migration complexity"
      - "Integration complexity"
      - "Data volume"
      - "Parallel operation duration"
      - "Training requirements"
      - "Custom development needs"

  - step_id: "identify_risks"
    name: "Identify Migration Risks"
    action: "risk_analysis"
    outputs: ["migration_risks"]
    common_risks:
      - "Detection gaps during transition"
      - "Performance degradation"
      - "Integration failures"
      - "User adoption challenges"
      - "Historical data availability"

  - step_id: "create_runbook"
    name: "Create Migration Runbook"
    action: "documentation"
    outputs: ["migration_runbook"]

outputs:
  format: "markdown"
  storage_path: "infohub/{realm}/{node}/specialists/security/migration_plan_{date}.md"
  sections:
    - "Executive Summary"
    - "Current State Assessment"
    - "Rule Analysis & Migration Matrix"
    - "Data Source Mapping"
    - "Migration Strategy"
    - "Phase Plan & Timeline"
    - "Resource Requirements"
    - "Risk Register & Mitigations"
    - "Success Criteria"
    - "Cutover Plan"

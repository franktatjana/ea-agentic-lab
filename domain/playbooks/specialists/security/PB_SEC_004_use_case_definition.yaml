# Security Use Case Definition Playbook
# Purpose: Define and document security detection use cases

id: "PB_SEC_004"
name: "Security Use Case Definition"
version: "1.0"
status: "ACTIVE"

metadata:
  category: "technical"
  framework: "Use Case Engineering"
  team_owner: "specialists"
  specialty: "security"
  description: "Structured definition of security detection and response use cases"

raci:
  responsible:
    role: "security_specialist"
    agent: "security_specialist_agent"
  accountable:
    role: "sa_lead"
    human_required: true
  consulted:
    - role: "customer_security_team"
      on_steps: ["requirements_validation", "testing"]
  informed:
    - role: "account_executives"

triggers:
  - event: "use_case_requested"
  - event: "poc_planning"
  - event: "implementation_scoping"

inputs:
  required:
    - name: "use_case_name"
      type: "string"
    - name: "use_case_category"
      type: "enum"
      options: ["threat_detection", "compliance", "insider_threat", "fraud", "operational_security"]
    - name: "business_context"
      type: "string"
  optional:
    - name: "reference_implementations"
      type: "list"
    - name: "regulatory_drivers"
      type: "list"

steps:
  - step_id: "gather_context"
    name: "Gather Business Context"
    action: "discovery"
    outputs: ["business_requirements"]

  - step_id: "define_detection_logic"
    name: "Define Detection Logic"
    action: "technical_design"
    outputs: ["detection_specification"]
    elements:
      - "Data sources required"
      - "Detection conditions/thresholds"
      - "Correlation logic"
      - "Time windows"
      - "Exclusions/allowlists"

  - step_id: "specify_data_requirements"
    name: "Specify Data Requirements"
    action: "data_mapping"
    outputs: ["data_requirements"]
    elements:
      - "Log sources"
      - "Required fields"
      - "Field normalizations"
      - "Data quality requirements"

  - step_id: "design_response"
    name: "Design Response Actions"
    action: "response_design"
    outputs: ["response_specification"]
    elements:
      - "Alert severity"
      - "Escalation path"
      - "Automated actions"
      - "Investigation runbook"

  - step_id: "define_metrics"
    name: "Define Success Metrics"
    action: "metrics_definition"
    outputs: ["success_metrics"]
    metrics:
      - "True positive rate"
      - "False positive rate"
      - "Mean time to detect"
      - "Coverage percentage"

  - step_id: "create_test_plan"
    name: "Create Test Plan"
    action: "test_planning"
    outputs: ["test_plan"]
    test_types:
      - "Unit tests (rule logic)"
      - "Integration tests (data flow)"
      - "Red team simulation"
      - "Performance testing"

  - step_id: "document_use_case"
    name: "Document Use Case"
    action: "documentation"
    outputs: ["use_case_document"]

outputs:
  format: "yaml"
  storage_path: "{realm}/{node}/external-infohub/use_cases/security/{use_case_id}.yaml"
  template: |
    use_case_id: "{{use_case_id}}"
    name: "{{use_case_name}}"
    version: "1.0"
    status: "draft"

    classification:
      category: "{{category}}"
      mitre_tactics: []
      mitre_techniques: []
      kill_chain_phase: ""

    description:
      summary: "{{summary}}"
      business_value: "{{business_value}}"
      threat_addressed: "{{threat}}"

    data_requirements:
      sources: []
      fields: []
      volume_estimate: ""

    detection_logic:
      type: "correlation|threshold|anomaly|pattern"
      conditions: []
      time_window: ""
      threshold: ""

    response:
      severity: "critical|high|medium|low"
      escalation: ""
      automated_actions: []
      runbook_link: ""

    testing:
      test_cases: []
      validation_method: ""

    metrics:
      target_detection_rate: ""
      acceptable_fp_rate: ""

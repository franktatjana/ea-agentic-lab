# APM Implementation Playbook

id: "PB_OBS_007"
name: "APM Implementation"
version: "1.0"
status: "ACTIVE"

metadata:
  category: "technical"
  framework: "APM Engineering"
  team_owner: "specialists"
  specialty: "observability"
  description: "Plan and execute Application Performance Monitoring implementation"

raci:
  responsible:
    role: "observability_specialist"
    agent: "observability_specialist_agent"
  accountable:
    role: "sa_lead"
    human_required: true
  consulted:
    - role: "customer_dev_team"
    - role: "customer_platform_team"
  informed:
    - role: "solution_architects"

triggers:
  - event: "apm_implementation_requested"
  - event: "application_onboarding"
  - event: "performance_improvement"

inputs:
  required:
    - name: "application_inventory"
      type: "list"
    - name: "technology_stack"
      type: "object"
    - name: "performance_requirements"
      type: "object"
  optional:
    - name: "existing_instrumentation"
    - name: "deployment_constraints"
    - name: "performance_baselines"

steps:
  - step_id: "assess_application_landscape"
    name: "Assess Application Landscape"
    outputs: ["application_assessment"]
    assessment:
      - "Application inventory"
      - "Technology stacks (Java, .NET, Python, Node.js, Go)"
      - "Deployment models (VM, container, serverless)"
      - "Communication patterns (sync, async, messaging)"
      - "Database technologies"

  - step_id: "plan_instrumentation"
    name: "Plan Instrumentation Strategy"
    outputs: ["instrumentation_plan"]
    instrumentation_approaches:
      auto_instrumentation:
        - "Agent-based (attach to runtime)"
        - "Bytecode instrumentation"
        - "Library injection"
      manual_instrumentation:
        - "SDK integration"
        - "OpenTelemetry API"
        - "Custom spans and metrics"
      hybrid:
        - "Auto for standard, manual for custom"

  - step_id: "configure_tracing"
    name: "Configure Distributed Tracing"
    outputs: ["tracing_config"]
    configuration:
      - "Sampling strategy (head, tail, adaptive)"
      - "Context propagation (W3C, B3)"
      - "Span attributes and metadata"
      - "Service naming conventions"

  - step_id: "setup_profiling"
    name: "Setup Continuous Profiling"
    outputs: ["profiling_config"]
    profiling_types:
      - "CPU profiling"
      - "Memory profiling"
      - "Wall-clock profiling"
      - "Lock contention"

  - step_id: "configure_error_tracking"
    name: "Configure Error Tracking"
    outputs: ["error_tracking_config"]
    configuration:
      - "Exception capture"
      - "Stack trace collection"
      - "Error grouping rules"
      - "Error alerting"

  - step_id: "build_service_maps"
    name: "Build Service Maps"
    outputs: ["service_map_config"]
    map_elements:
      - "Service dependencies"
      - "Health indicators"
      - "Performance metrics"
      - "Error rates"

  - step_id: "create_apm_dashboards"
    name: "Create APM Dashboards"
    outputs: ["apm_dashboards"]
    dashboard_types:
      - "Service overview"
      - "Transaction analysis"
      - "Dependency performance"
      - "Error analysis"
      - "Infrastructure correlation"

  - step_id: "document_implementation"
    name: "Document Implementation"
    outputs: ["implementation_documentation"]

outputs:
  format: "markdown"
  storage_path: "{realm}/{node}/external-infohub/specialists/observability/apm_{date}.md"
  sections:
    - "Implementation Summary"
    - "Application Inventory"
    - "Instrumentation Guide"
    - "Tracing Configuration"
    - "Profiling Setup"
    - "Error Tracking"
    - "Dashboard Catalog"
    - "Operational Procedures"

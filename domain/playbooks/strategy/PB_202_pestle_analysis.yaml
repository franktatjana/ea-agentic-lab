# PLAYBOOK: PESTLE Analysis (Macro-Environmental Assessment)
# Framework operationalization for AI agents
# PLAYBOOK_EXECUTION_SPECIFICATION v1.0 standard

# ==============================================================================
# PLAYBOOK METADATA
# ==============================================================================
framework_name: "PESTLE Analysis"
framework_source: "Francis Aguilar (ETPS, 1967), expanded to PESTLE"
playbook_mode: "GENERATIVE"
playbook_category: "strategic_frameworks"
intended_agent_role: "AE Agent"
secondary_agents: ["SA Agent", "CI Agent", "InfoSec Agent"]

primary_objective: "Analyze external macro-environmental factors (Political, Economic, Social, Technological, Legal, Environmental) affecting the customer to identify opportunities and threats, inform strategic positioning, and anticipate market shifts"

when_not_to_use:
  - "Tactical short-term decision (PESTLE is strategic)"
  - "Internal capability assessment needed (use SWOT instead)"
  - "No customer industry context available"
  - "Account engagement < 30 days (insufficient context)"

# ==============================================================================
# TRIGGER CONDITIONS
# ==============================================================================
trigger_conditions:
  automatic:
    - event: "new_strategic_account"
      description: "New strategic account onboarding"

    - event: "major_market_event"
      description: "Significant market disruption affecting customer industry"

    - event: "regulatory_change"
      description: "New regulation affects customer's industry"

    - event: "annual_strategic_review"
      description: "Annual account strategy planning"

    - event: "geographic_expansion"
      description: "Customer expanding to new regions/markets"

  manual:
    - "AE requests market context analysis"
    - "Customer requests strategic alignment discussion"
    - "Sales leadership requests industry positioning"

  conditional:
    - condition: "$.customer.industry_risk_score > 0.7"
      description: "High industry volatility detected"

    - condition: "$.customer.regulatory_exposure == 'high'"
      description: "Customer operates in highly regulated industry"

# ==============================================================================
# REQUIRED INPUTS
# ==============================================================================
validation_inputs:
  mandatory:
    - artifact: "{realm}/{node}/external-infohub/overview.md"
      description: "Account overview with industry context"
    - artifact: "Customer industry classification"
      description: "Industry/sector identification"
    - artifact: "Customer geographic footprint"
      description: "Regions/countries of operation"

  optional:
    - artifact: "{realm}/{node}/external-infohub/meetings/*"
      use: "Extract customer concerns about external factors"
    - artifact: "Industry reports"
      use: "Market trends and forecasts"
    - artifact: "Regulatory filings"
      use: "Compliance requirements and changes"
    - artifact: "{realm}/intelligence/tech_signal_map/current_radar.yaml"
      use: "Technology trends affecting customer"
    - artifact: "CI Agent competitive reports"
      use: "Industry competitive dynamics"
    - artifact: "News/press releases"
      use: "Recent developments affecting customer"

  minimum_data_threshold:
    - "Customer industry and primary markets identified"
    - "At least 1 external factor documented per PESTLE dimension"

# ==============================================================================
# KEY QUESTIONS TO EXTRACT
# ==============================================================================
key_questions:
  political:
    - "What government policies affect the customer's industry (subsidies, tariffs, trade policies)?"
    - "What political stability/instability exists in customer's key markets?"
    - "What government priorities align with or oppose customer's business model?"
    - "What public sector contracts or dependencies exist?"
    - "What geopolitical tensions could impact customer operations?"
    - "How do data sovereignty requirements affect customer's technology decisions?"

  economic:
    - "What is the economic outlook for customer's primary markets?"
    - "What inflation, interest rate, or currency risks affect customer?"
    - "What industry-specific economic cycles impact customer?"
    - "What is customer's sensitivity to economic downturns?"
    - "What cost pressures or efficiency mandates exist?"
    - "What IT budget trends exist in customer's industry?"

  social:
    - "What demographic changes affect customer's market or workforce?"
    - "What cultural shifts impact customer's products/services?"
    - "What workforce trends affect customer (remote work, skills gaps)?"
    - "What consumer behavior changes impact customer?"
    - "What ESG/sustainability expectations exist from stakeholders?"
    - "What public perception or reputation factors matter?"

  technological:
    - "What technology disruptions could transform customer's industry?"
    - "What digital transformation initiatives is customer pursuing?"
    - "What emerging technologies (AI, cloud, IoT) affect customer?"
    - "What technology adoption rate exists in customer's industry?"
    - "What infrastructure modernization needs exist?"
    - "What cybersecurity threats target customer's industry?"
    - "What automation/efficiency technology trends apply?"

  legal:
    - "What data privacy regulations affect customer (GDPR, CCPA, etc.)?"
    - "What industry-specific compliance requirements exist?"
    - "What intellectual property considerations apply?"
    - "What employment law changes affect customer?"
    - "What contract/liability risks exist?"
    - "What regulatory enforcement trends affect customer's industry?"

  environmental:
    - "What sustainability regulations affect customer?"
    - "What carbon reduction commitments has customer made?"
    - "What environmental risks affect customer's operations?"
    - "What green technology opportunities exist?"
    - "What supply chain sustainability requirements apply?"
    - "What ESG reporting requirements exist?"

# ==============================================================================
# DECISION LOGIC (DLL Syntax)
# ==============================================================================
decision_logic:
  rules:
    # High regulatory risk
    - id: "regulatory_risk_high"
      condition: "$.pestle.legal.items[?(@.impact=='high')].length >= 2 OR $.pestle.political.items[?(@.impact=='high' && @.category=='regulation')].length >= 1"
      severity: "HIGH"
      output_type: "Risk + Initiative"
      decision:
        title: "High regulatory exposure for {node}"
        context: "Multiple high-impact regulatory factors require compliance positioning"
        recommendation: "Position compliance and governance capabilities as strategic differentiators"
        actions:
          - "Engage InfoSec Agent for compliance capability mapping"
          - "Prepare regulatory compliance value proposition"
          - "Identify compliance-related expansion opportunities"
        owner: "Account Executive"
      creates:
        - object_type: "Risk"
          category: "regulatory"
          severity: "MEDIUM"
        - object_type: "Initiative"
          priority: "HIGH"

    # Technology disruption opportunity
    - id: "technology_disruption_opportunity"
      condition: "$.pestle.technological.items[?(@.type=='disruption' && @.alignment=='high')].length >= 1"
      severity: "MEDIUM"
      output_type: "Initiative"
      decision:
        title: "Technology disruption alignment for {node}"
        context: "Industry technology shifts create strategic opportunity"
        recommendation: "Position as transformation partner for technology adoption"
        actions:
          - "Map capabilities to customer's technology transformation needs"
          - "Prepare thought leadership content for customer industry"
          - "Engage PM Agent for roadmap alignment discussion"
        owner: "Account Executive"
      creates:
        - object_type: "Initiative"
          priority: "HIGH"

    # Economic headwind risk
    - id: "economic_headwind_risk"
      condition: "$.pestle.economic.items[?(@.type=='headwind' && @.impact=='high')].length >= 1"
      severity: "MEDIUM"
      output_type: "Risk"
      decision:
        title: "Economic headwind risk for {node}"
        context: "Economic factors may pressure customer budgets"
        recommendation: "Prepare cost optimization and efficiency messaging"
        actions:
          - "Engage Value Engineering for TCO/ROI analysis"
          - "Prepare cost consolidation positioning"
          - "Identify efficiency-driven opportunities"
        owner: "Account Executive"
      creates:
        - object_type: "Risk"
          category: "economic"
          severity: "MEDIUM"

    # Sustainability opportunity
    - id: "sustainability_initiative"
      condition: "$.pestle.environmental.items[?(@.type=='opportunity')].length >= 1 OR $.pestle.social.items[?(@.category=='ESG')].length >= 1"
      severity: "LOW"
      output_type: "Initiative"
      decision:
        title: "Sustainability positioning for {node}"
        context: "Customer has ESG/sustainability drivers"
        recommendation: "Align messaging with customer's sustainability initiatives"
        actions:
          - "Map capabilities to sustainability/efficiency outcomes"
          - "Prepare green technology positioning"
          - "Identify sustainability-related use cases"
        owner: "Account Executive"
      creates:
        - object_type: "Initiative"
          priority: "MEDIUM"

    # Multiple high-impact threats
    - id: "multiple_threats_escalation"
      condition: "$.pestle.threats_count >= 5"
      severity: "HIGH"
      output_type: "Risk + Decision"
      decision:
        title: "Multiple external threats for {node}"
        context: "Customer faces significant macro-environmental challenges"
        recommendation: "Review strategic account priority and resource allocation"
        actions:
          - "Assess impact on customer's ability to invest"
          - "Evaluate account risk profile"
          - "Consider defensive account strategy"
        escalate_to: "Sales Leadership"
      creates:
        - object_type: "Risk"
          category: "strategic"
          severity: "HIGH"
        - object_type: "Decision"
          severity: "MEDIUM"

    # Geopolitical risk
    - id: "geopolitical_risk"
      condition: "$.pestle.political.items[?(@.category=='geopolitical' && @.impact=='high')].length >= 1"
      severity: "HIGH"
      output_type: "Risk"
      decision:
        title: "Geopolitical risk exposure for {node}"
        context: "Customer operations affected by geopolitical factors"
        recommendation: "Assess data sovereignty and operational resilience requirements"
        actions:
          - "Review data residency requirements"
          - "Assess regional deployment implications"
          - "Engage InfoSec for compliance review"
        owner: "Account Executive"
      creates:
        - object_type: "Risk"
          category: "geopolitical"
          severity: "HIGH"

# ==============================================================================
# EXPECTED OUTPUTS
# ==============================================================================
validation_outputs:
  primary_artifact:
    path: "{realm}/{node}/internal-infohub/frameworks/pestle_analysis_{YYYY-MM-DD}.md"
    format: "markdown"
    sections:
      - executive_summary
      - political_analysis
      - economic_analysis
      - social_analysis
      - technological_analysis
      - legal_analysis
      - environmental_analysis
      - opportunities_summary
      - threats_summary
      - strategic_implications

    schema:
      political:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["policy", "regulation", "stability", "geopolitical", "public_sector"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["opportunity", "threat", "neutral"]}
          timeframe: {type: "string", enum: ["immediate", "short_term", "medium_term", "long_term"]}
          our_response: {type: "string", nullable: true}
          evidence:
            type: "array"
            required: true
            items:
              source_artifact: {type: "string", required: true}
              date: {type: "string", required: true}
              excerpt: {type: "string", required: true}

      economic:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["growth", "inflation", "currency", "budget", "industry_cycle"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["tailwind", "headwind", "neutral"]}
          timeframe: {type: "string"}
          our_response: {type: "string", nullable: true}
          evidence:
            type: "array"
            required: true

      social:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["demographics", "culture", "workforce", "consumer", "ESG"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["opportunity", "threat", "neutral"]}
          our_response: {type: "string", nullable: true}
          evidence:
            type: "array"
            required: true

      technological:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["disruption", "adoption", "infrastructure", "security", "automation"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["opportunity", "threat", "neutral"]}
          alignment: {type: "string", enum: ["high", "medium", "low"], description: "How well our capabilities align"}
          our_response: {type: "string", nullable: true}
          evidence:
            type: "array"
            required: true

      legal:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["privacy", "compliance", "ip", "employment", "liability"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["requirement", "risk", "opportunity"]}
          compliance_capability: {type: "string", nullable: true, description: "Our relevant compliance capability"}
          evidence:
            type: "array"
            required: true

      environmental:
        type: "array"
        items:
          factor: {type: "string", required: true}
          category: {type: "string", enum: ["sustainability", "carbon", "supply_chain", "reporting", "green_tech"]}
          impact: {type: "string", enum: ["high", "medium", "low"]}
          type: {type: "string", enum: ["opportunity", "requirement", "risk"]}
          our_response: {type: "string", nullable: true}
          evidence:
            type: "array"
            required: true

      summary:
        type: "object"
        properties:
          total_opportunities: {type: "number"}
          total_threats: {type: "number"}
          highest_impact_factors: {type: "array"}
          strategic_positioning: {type: "string", required: true}

  decision_objects:
    path: "{realm}/{node}/external-infohub/decisions/"
    create_if:
      - "Major strategic pivot required due to external factors"
      - "Resource reallocation needed for compliance"

  risk_objects:
    path: "{realm}/{node}/internal-infohub/risks/"
    create_if:
      - "High-impact external threat identified"
      - "Regulatory compliance risk"
      - "Economic headwind risk"

  initiative_objects:
    path: "{realm}/{node}/internal-infohub/initiatives/"
    create_if:
      - "External opportunity aligns with capabilities"
      - "Compliance positioning opportunity"
      - "Technology disruption alignment"

# ==============================================================================
# STOP CONDITIONS
# ==============================================================================
stop_conditions:
  escalate_to_human:
    - condition: "$.customer.industry == null"
      reason: "Cannot perform PESTLE without industry classification"
      action: "Request AE to provide customer industry context"

    - condition: "$.pestle.high_impact_threats >= 4"
      reason: "Significant external risk exposure requires executive review"
      action: "Escalate to Sales Leadership for account risk assessment"

    - condition: "$.customer.geographies == null"
      reason: "Geographic context required for political/legal analysis"
      action: "Request customer geographic footprint information"

  insufficient_data_signals:
    - "No industry context available"
    - "Customer's market/competitive context unknown"
    - "No recent news or developments tracked"

  ambiguity_signals:
    - "Conflicting market signals"
    - "Unclear regulatory jurisdiction"
    - "Multiple industries with different PESTLE profiles"

# ==============================================================================
# VALIDATION CHECKS
# ==============================================================================
validation_checks:
  pre_execution:
    - check: "$.client_id EXISTS"
      description: "Client ID must exist in InfoHub"
    - check: "$.customer.industry EXISTS"
      description: "Customer industry must be identified"

  post_execution:
    - check: "$.pestle.dimensions_covered >= 4"
      description: "At least 4 PESTLE dimensions analyzed"
    - check: "evidence_validation_passed"
      description: "All factors have evidence citations"
    - check: "$.pestle.summary.strategic_positioning EXISTS"
      description: "Strategic positioning recommendation provided"

  output_quality:
    - "All factors correctly categorized (P/E/S/T/L/E)"
    - "External factors only (no internal factors)"
    - "All factors have impact assessment"
    - "Opportunities and threats clearly distinguished"

# ==============================================================================
# FRAMEWORK REFERENCE
# ==============================================================================
framework_reference:
  pestle_dimensions:
    political:
      definition: "Government policies, political stability, trade policies, taxation"
      examples: ["Trade tariffs", "Government contracts", "Political instability", "Data sovereignty mandates"]

    economic:
      definition: "Economic growth, inflation, interest rates, exchange rates, industry cycles"
      examples: ["Recession risk", "Currency fluctuation", "IT budget trends", "Industry growth rates"]

    social:
      definition: "Demographics, culture, lifestyle changes, workforce trends"
      examples: ["Remote work adoption", "Skills shortages", "Consumer behavior shifts", "ESG expectations"]

    technological:
      definition: "Technology adoption, R&D, automation, digital disruption"
      examples: ["AI/ML adoption", "Cloud migration", "Cybersecurity threats", "Digital transformation"]

    legal:
      definition: "Regulations, compliance requirements, consumer protection, employment law"
      examples: ["GDPR", "Industry regulations", "Data residency requirements", "Employment law changes"]

    environmental:
      definition: "Sustainability, climate change, environmental regulations, green technology"
      examples: ["Carbon reduction mandates", "ESG reporting", "Sustainable supply chain", "Green IT initiatives"]

# ==============================================================================
# EXECUTION METADATA
# ==============================================================================
last_updated: "2026-02-02"
version: "1.0"
status: "production_ready"
notes: "PESTLE Analysis playbook for macro-environmental assessment and strategic positioning"
